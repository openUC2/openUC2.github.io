<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Electronics/FRAMEElectronics">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">FRAME Electronics Hardware | openUC2 Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.youseetoo.org/docs/Electronics/FRAMEElectronics"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="FRAME Electronics Hardware | openUC2 Documentation"><meta data-rh="true" name="description" content="Development repository for electronic parts of the mAIkroscope (formerly fiveD/XYZ)"><meta data-rh="true" property="og:description" content="Development repository for electronic parts of the mAIkroscope (formerly fiveD/XYZ)"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.youseetoo.org/docs/Electronics/FRAMEElectronics"><link data-rh="true" rel="alternate" href="https://docs.youseetoo.org/docs/Electronics/FRAMEElectronics" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.youseetoo.org/docs/Electronics/FRAMEElectronics" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://DB3UCAMZ89-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="openUC2 Documentation" href="/opensearch.xml">

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>var pdfData={};const getBaseUrl=function(n){return"/"},getDownloadItems=function(){for(var n,e=[],t=pdfData[(n=document.location.pathname,n.endsWith("/")?n.slice(0,-1):n)]||[],o=0,l=t.length;o<l;o++)"root"!==t[o].type?"section"!==t[o].type?"chapter"===t[o].type&&e.push({title:"Download page: <br/> <strong style=font-size:16px>"+t[o].label+"</strong>",path:"/"+t[o].file}):e.push({title:"Download section: <br/> <strong style=font-size:16px>"+t[o].label+"</strong>",path:"/"+t[o].file}):e.push({title:"Download complete version: <br/> <strong style=font-size:16px>"+t[o].label+"</strong>",path:"/"+t[o].file});return e},fillDownloadDropdownMenu=function(){$("#pdfDownloadMenuList").empty();const n=getDownloadItems();var e="";n.forEach((function(n){e+="<li>",e+='<a class="dropdown__link" href="'+n.path+'" download>'+n.title+"</a>",e+="</li>"})),0===e.length&&(e="<li>No PDF downloads on this page</li>"),$("#pdfDownloadMenuList").append(e)},fillDownloadSidebarMenu=function(){$("#pdfLinkSidebarMenu").empty();const n=getDownloadItems();var e="";n.forEach((function(n){e+='<li class="menu__list-item">',e+='<a class="menu__link" href="'+n.path+'" download>'+n.title+"</a>",e+="</li>"})),0===e.length&&(e="<li>No PDF downloads on this page</li>"),$("#pdfLinkSidebarMenu").append(e)},checkAndInsertPdfButtons=function(){if($("html").hasClass("plugin-docs")){if(!$("#pdfLink").length){var n=$('<div class="navbar__item dropdown dropdown--hoverable dropdown--right" id="pdfDownloadMenu">  <a class="navbar__item navbar__link pdfLink" id="pdfLink" href="#">Download as PDF</a>  <ul class="dropdown__menu" id="pdfDownloadMenuList"></ul></div>');$(".navbar__items--right").prepend(n),$("#pdfDownloadMenu").mouseenter(fillDownloadDropdownMenu)}if(!$("#pdfLinkSidebar").length){var e=$('<li class="menu__list-item menu__list-item--collapsed" id="pdfLinkSidebar"><a role="button" class="menu__link menu__link--sublist">Download as PDF</a><ul class="menu__list" id="pdfLinkSidebarMenu" style=""></ul></li>');$(".navbar-sidebar__items > .menu > .menu__list").append(e),$("#pdfLinkSidebar").click((function(){$("#pdfLinkSidebar").toggleClass("menu__list-item--collapsed")})),$(".navbar__toggle").click(fillDownloadSidebarMenu)}}};$(window).on("load",(function(){fetch("/pdfs.json").then((n=>n.json())).then((function(n){pdfData=n,checkAndInsertPdfButtons(),setInterval(checkAndInsertPdfButtons,1e3)}))}))</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.2142b3d2.css">
<link rel="preload" href="/assets/js/runtime~main.482c0bff.js" as="script">
<link rel="preload" href="/assets/js/main.35ca945d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Artboard4@4x.png" alt="openUC2 Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/Artboard4@4x.png" alt="openUC2 Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">openUC2 Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openuc2/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/General/ModuleDeveloperKit/">General</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Toolboxes/">Educational Kits</a><button aria-label="Toggle the collapsible sidebar category &#x27;Educational Kits&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Investigator/ZMicroscope/UpackZMicroscope">Investigator</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Electronics/uc2e1">Electronics</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e1">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e2v2">UC2 Standalone Board V2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e2v3">UC2 Standalone Board V3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e3">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e5">REST principle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e5.1">REST commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e6">Connecting devices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e7">Controlling the UC2e</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/Controlling_the_ESP32_APP">UC2Serial Android App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e8">Compiling from Scratch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e9">Replace Hardware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/PS4-Controller">PS4-Controller</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/StepperMotorBackpack">Documentation for Stepper Motor Controller with Rotational Encoder (TMC2209 + AS5600)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Electronics/FRAMEElectronics">FRAME Electronics Hardware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/RaspberryPiHat+">HAT+</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/CANInterface">CANInterface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e5.2">Python commands</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Electronics/UC2-ESP/Setup_Buildenvironment">UC2-ESP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Electronics/UC2-REST/INTRO">UC2-REST</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/ImSwitch/DahengCamera">ImSwitch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/WORKSHOPS/">openUC2 Workshops</a><button aria-label="Toggle the collapsible sidebar category &#x27;openUC2 Workshops&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/PRODUCTION/INVESTIGATOR/ProductionXYZMicroscope">PRODUCTION</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">openUC2 Documentation</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Electronics</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">FRAME Electronics Hardware</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>FRAME Electronics Hardware</h1><p>Development repository for electronic parts of the mAIkroscope (formerly fiveD/XYZ)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of Contents<a class="hash-link" href="#table-of-contents" title="Direct link to heading">​</a></h2><ul><li><a href="#maikroscope-electronics-hardware">mAIkroscope-electronics-hardware</a><ul><li><a href="#table-of-contents">Table of Contents</a></li><li><a href="#canbus-as-communication-between-devices">CANBUS as communication between devices</a></li><li><a href="#hatplus-for-raspberrypi-5">hatplus-for-raspberrypi-5</a><ul><li><a href="#raspberry-pi-hat-implementation-eeproms-hat-spec">Raspberry Pi HAT+ implementation (EEPROMS, HAT+ spec)</a></li><li><a href="#raspberry-pi-pinout">Raspberry Pi pinout</a></li><li><a href="#esp32-pinout">ESP32 pinout</a></li><li><a href="#emergency-stop-connector">Emergency STOP connector</a></li><li><a href="#hat-terminating-canbus-or-activating-can-activity-indicator-led">HAT: Terminating CANBUS or activating CAN activity indicator LED</a></li><li><a href="#disabling-communication-or-power-switching-functions">Disabling communication or power-switching functions</a></li></ul></li><li><a href="#stepper-backpack">stepper-backpack</a><ul><li><a href="#pinout">Pinout</a></li><li><a href="#current-sensing-and-current-setting">Current sensing and current setting</a></li><li><a href="#converting-rev-c-from-12vcan-to-5vi2c">Converting Rev. C from 12V+CAN to 5V+I2C</a></li><li><a href="#terminating-canbus-or-activating-can-activity-indicator-led">Terminating CANBUS or activating CAN activity indicator LED</a></li></ul></li><li><a href="#laser-interface">Laser-interface</a><ul><li><a href="#xiao-pinout">XIAO pinout</a></li><li><a href="#keyswitch-specifications-and-connections">Keyswitch specifications and connections</a></li><li><a href="#interlock">Interlock</a><ul><li><a href="#interlock-behavior-and-status-inticators">Interlock behavior and status inticators</a></li><li><a href="#interlock-sources">Interlock sources</a></li><li><a href="#interlock-overrides">Interlock overrides</a></li></ul></li><li><a href="#solderjumpers">Solderjumpers</a></li><li><a href="#using-the-board-as-can-to-gpio-converter">Using the board as CAN-to-GPIO converter</a></li></ul></li><li><a href="#pogopin-connectors">Pogopin-connectors</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="canbus-as-communication-between-devices">CANBUS as communication between devices<a class="hash-link" href="#canbus-as-communication-between-devices" title="Direct link to heading">​</a></h2><p>CANBUS is a differential bus where many devices are connected to the same CAN_H and CAN_L wires, then can communicate with each other.</p><p>The electrical functionality requires a dedicated CAN transceiver chip for every device connecting to the bus. The receiver converts differential signaling on the bus to input and output interfaces, while providing tolerance to voltages of commonly 20V on the CAN_H/CAN-L and isolating faulty voltages from reaching to the GPIOs of connected controllers.</p><p>The two wires of CANBUS need to be connected together with two 120 Ohm resistors at opposite ends. This termination is like impedance matching and prevents the signals to reflect back from a far end of the bus wires. The terminators should be placed on the ends that are farthest apart, and can probably be integrated on PCBs of the devices that are farthest apart. The &quot;backbone&quot; with the termination on both ends should be much longer than the taps (&quot;stubs&quot;) from the backbone to the devices. The physical wires, electrical specs (like differential signaling and voltage levels) are OSI layer 1.</p><p>CAN message collision avoidance is done in a CAN controller. This is available as a separate chip (with SPI interface), but it is also integrated as peripheral in the ESP32. At the start of each frame, every device wanting to send something starts sending their CAN ID (programmed into the device, must be unique). If a device has a lower ID, it gets priority by sending a dominant bit (logical 0, CAN_H and CAN_L are driven to different voltage levels) where other devices send a logical 1 (recessive bit, CAN_H and CAN_L are not driven making them return to equal voltage). If a device with a higher ID gets overruled this way, it will listen in this frame cycle and waits for the next frame to start before attempting to transmit its ID again. The frames also contain set amount of data and error checking bits.</p><p>There are frame types to request data (Remote frame), data containing (data frame), errror frame (when error is detected) and overload frame (indicating delay between data or remote frames is needed).</p><p>That is Link Layer (OSI layer 2).</p><p>OSI Layers 1 and 2 as implemented are standardized with ISO 11898-1.</p><p>ESP32 calls their implementation of this and maybe higher OSI layers TWAI: <a href="https://docs.espressif.com/projects/esp-idf/en/v4.2.1/esp32/api-reference/peripherals/twai.html" target="_blank" rel="noopener noreferrer">https://docs.espressif.com/projects/esp-idf/en/v4.2.1/esp32/api-reference/peripherals/twai.html</a></p><p>ESP32 CAN controller is not compatible with CAN FD (flexible data-rate), just classical CAN with 11-bit IDs (Standard Frame Format) and 29-bit IDs (Extended Frame Format).</p><p>The ESP32 TWAI controller depends on getting a receiving signal at the same time that it is sending something in order to work, because that is how it can determine if it is allowed to talk (CAN ID arbitration/priorities).</p><p>Higher OSI layers, like Network (OSI 3) and up are implemented in higher-layer protocols like CANopen. That implements flow control, multi-frame data segmentation, device addressing.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hatplus-for-raspberrypi-5">hatplus-for-raspberrypi-5<a class="hash-link" href="#hatplus-for-raspberrypi-5" title="Direct link to heading">​</a></h2><p><a href="/docs/Electronics/kicad/hatplus-for-raspberrypi-5/OUTPUTS/for-humans/hatplus-for-raspberrypi-5.pdf">Schematic PDF</a></p><p><a href="/docs/Electronics/kicad/hatplus-for-raspberrypi-5/OUTPUTS/for-humans/ibom.html">ibom HTML</a></p><p>This board is effectively the mainboard for the mAIkroscope. It contains DC power input for the whole machine, switched power transmission to all motors, main coordinating microcontroller and interfacing with a Raspberry Pi.</p><p>The HAT is put on top of a Raspberry Pi 5 and can supply it with 5.1V 5A through the 40-pin header. The HAT will also fit on a NVIDIA Jetson development board, because its 40-pin header is designed to be compatible with Raspberry Pi&#x27;s.</p><p>There are many comments for design choices, mechanisms, failsafes and links to external ressources in the <a href="/docs/Electronics/kicad/hatplus-for-raspberrypi-5/OUTPUTS/for-humans/hatplus-for-raspberrypi-5.pdf">schematic PDF for our HAT</a>.</p><p>The microcontroller is a ESP32-WROOM-32E-N8 module with integrated PCB antenna, 8 MB flash. The used ESP32-D0WD-V3 chip in the module has 449 KB ROM, 520 KB SRAM and 16 KB SRAM in RTC core.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="raspberry-pi-hat-implementation-eeproms-hat-spec">Raspberry Pi HAT+ implementation (EEPROMS, HAT+ spec)<a class="hash-link" href="#raspberry-pi-hat-implementation-eeproms-hat-spec" title="Direct link to heading">​</a></h3><p>Our HAT is designed to comply with <a href="https://datasheets.raspberrypi.com/hat/hat-plus-specification.pdf" target="_blank" rel="noopener noreferrer">Raspberry Pi HAT+ specifications</a>.</p><p>However, it has the function of 2 types of HAT+s: Power supply and using the GPIO header for data exchange purposes.</p><p>The I2C addresses of EEPROMS on the HAT indicate the HAT+ class to the Raspberry Pi firmware. In multiple HAT+ stacked on one Raspberry Pi, there can be only one HAT of each class per spec and to avoid I2C address collisions.</p><p>The HAT has 2 EEPROM chips with functions and content:</p><table><thead><tr><th>I2C Address</th><th>HAT+ class meaning</th><th>EEPROM contents</th></tr></thead><tbody><tr><td>0x1010_000</td><td>Standard (uses GPIO for data)</td><td>tbd</td></tr><tr><td>0x1010_000</td><td>Power: MODE1 (can deliver 5A)</td><td>tbd</td></tr></tbody></table><p>The content of the HAT can be custom content like serial numbers, manufacturer, or drivers/instructions for the Raspberry Pi OS on how to interface with the HAT. The format and mandatory fields are in the Raspberry Pi HAT+ spec document.</p><p>For our HAT, it would make sense to fill the EEPROMS for these functions:</p><ul><li>Ensure that the full power for USB devices is automatically activated (implementing a MODE1 HAT+).</li><li>Add our company name, product name, board revision, unique serial number that we keep track of in the company</li><li>Driver or interface/pin description to make the SPI CAN controller chip (MCP2515) available to python scripts via Linux.</li><li>Descriptions of other GPIO pin functions, to be able to use them abstractly in future scripts: buspower_EN, ESP32 interface UART and flashing, etc</li><li>Maybe things like hardware configuration options that should &quot;just work&quot;, like what features and modules the mAIkroscope model has that it is built into, and factory calibration data for its modules</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="raspberry-pi-pinout">Raspberry Pi pinout<a class="hash-link" href="#raspberry-pi-pinout" title="Direct link to heading">​</a></h3><p>For Raspberry Pi pin numbering and assignable or fixed functions, see <a href="https://pinout.xyz" target="_blank" rel="noopener noreferrer">pinout.xyz</a>.</p><p>In the table is the physical/board pin number, not GPIO number. The pin numbering on the header is odd-even.</p><table><thead><tr><th>RPi</th><th>Function</th></tr></thead><tbody><tr><td>3</td><td>I2C-1_SDA connectable to ESP and XH_5V+I2C via solderjumper JP101</td></tr><tr><td>5</td><td>I2C-1_SCL connectable to ESP and  XH_5V+I2C via solderjumper JP102</td></tr><tr><td>8</td><td>UART_TX to ESP (parallel with USB-UART TX)</td></tr><tr><td>10</td><td>UART_RX from ESP (parallel with USB-UART RX)</td></tr><tr><td>11</td><td>ESP Auto-program circuit RTS</td></tr><tr><td>16</td><td>buspower-off when HI</td></tr><tr><td>19</td><td>CAN-Controller SPI PICO</td></tr><tr><td>21</td><td>CAN-Controller SPI POCI</td></tr><tr><td>23</td><td>CAN-Controller SPI SCK</td></tr><tr><td>24</td><td>CAN-Controller SPI CS</td></tr><tr><td>26</td><td>EEPROM I2C-0 SCL (HAT+ spec)</td></tr><tr><td>27</td><td>EEPROM I2C-0 SDA (HAT+ spec)</td></tr><tr><td>32</td><td>CAN-Controller Interrupt</td></tr><tr><td>36</td><td>ESP Auto-program circuit DTR</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="esp32-pinout">ESP32 pinout<a class="hash-link" href="#esp32-pinout" title="Direct link to heading">​</a></h3><p>Actual chosen model is ESP32-WROOM-32E-N8.</p><p>It is programmable via the USB-C port and CP2102 USB-Serial chip, or via Raspberry Pi UART (manual press of BOOT and RST necessary, or programming of the 2 Raspberry Pi GPIO to use the Auto-program circuit).</p><p>In the table are only GPIOs that are used and notable for the HAT. All GPIOs are also available at testpoints.</p><table><thead><tr><th>GPIO</th><th>Function</th></tr></thead><tbody><tr><td>4</td><td>Buspower_off when HI</td></tr><tr><td>17</td><td>CAN/TWAI Recieve</td></tr><tr><td>18</td><td>CAN/TWAI Send</td></tr><tr><td>19</td><td>Neopixel LED data</td></tr><tr><td>21</td><td>I2C-1_SDA to XH_5V+I2C connector and solderjumpable to Raspi</td></tr><tr><td>22</td><td>I2C-1_SCL to XH_5V+I2C connector and solderjumpable to Raspi</td></tr><tr><td>27</td><td>Camera-IO-interface Cam In Line 0</td></tr><tr><td>32</td><td>Camera-IO-interface Cam Out Line 1</td></tr><tr><td>33</td><td>Camera-IO-interface Cam In/Out Line 2</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="emergency-stop-connector">Emergency STOP connector<a class="hash-link" href="#emergency-stop-connector" title="Direct link to heading">​</a></h3><p>There is a 3.5 mm TRS connector (stereo headphones) to connect an external box with a Emergency-STOP button and LEDs (optional). It is J501 and oriented out the back of the mAIkroscope.</p><p>A STOP button should be normally closed, and should open and lock when pressed. This button should be connected between Tip and Ring of the TRS connector. This button is required for Buspower (5V or 12V out of the respective XH jacks) to turn on.</p><p>LEDs can be placed in or on the external box so it is easily visible in dark conditions. The LEDs have a budget of 3.3V and 20 mA, and resistors should be included in the box. If more amperage is pulled, the HAT may recognize it as STOP button press. Connect LEDs with High side at Tip and Low side at Sleeve of TRS connector. LEDs will always be lit regardless of STOP button state.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hat-terminating-canbus-or-activating-can-activity-indicator-led">HAT: Terminating CANBUS or activating CAN activity indicator LED<a class="hash-link" href="#hat-terminating-canbus-or-activating-can-activity-indicator-led" title="Direct link to heading">​</a></h3><p>Close JP jumpers by making a solder bridge between the 2 pads. To open a NO (normally open) solderjumper again, wipe, wick or suck away the solder bridge. To open a NC (normally closed) solderjumper, cut the trace between the pads with a knife very carefully and not cutting too deep. Design flaw: Cutting too deep exposes the copper of the inner layers and may cut or short traces on the inner layers. The cut should be planned in the PCB editor, and the trench should be cleaned up and filled with solder mask after cutting. In future, use 0-Ohm resistors for NC.</p><table><thead><tr><th>Operation</th><th>Effect</th></tr></thead><tbody><tr><td>Close JP1001</td><td>Terminates CANBUS on the board by connecting CAN_H and CAN_L through 120 Ohm resistor</td></tr><tr><td>Close JP1002</td><td>Red LED D1001 lights when CAN bus is in dominant state (logical 0, lines at different voltages)</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-communication-or-power-switching-functions">Disabling communication or power-switching functions<a class="hash-link" href="#disabling-communication-or-power-switching-functions" title="Direct link to heading">​</a></h3><p>This is only relevant for troubleshooting and may defeat safety functions.</p><table><thead><tr><th>Operation</th><th>Effect</th></tr></thead><tbody><tr><td>Close JP201</td><td>ESP and Raspberry Pi can no longer turn off buspower via GPIO pin</td></tr><tr><td>Close JP601</td><td>Override all buspower-off sources including Emergency-STOP button. Button SW601 can still momentary turn-off buspower.</td></tr><tr><td>Open JP901</td><td>Disconnect Raspberry pin from RTS line of CP2102 and Auto-program circuit</td></tr><tr><td>Open JP902</td><td>Disconnect Raspberry pin from DTR line of CP2102 and Auto-program circuit</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stepper-backpack">stepper-backpack<a class="hash-link" href="#stepper-backpack" title="Direct link to heading">​</a></h2><p><a href="/docs/Electronics/kicad/stepper-backpack/OUTPUTS/for-humans/stepper-backpack.pdf">Schematic PDF</a></p><p><a href="/docs/Electronics/kicad/stepper-backpack/OUTPUTS/for-humans/ibom.html">ibom HTML</a></p><p>stepper-backpack is a PCB to fasten to the back of a NEMA 11 stepper motor. It enables the motor-PCB-assembly to be controlled via CAN with high-level commands and implements absolute feedback.</p><ul><li>Glue a circular magnet to the end of the stepper motor&#x27;s axle</li><li>Mount the PCB to the back of the motor using 3 pcs of M2.5 screws with cylindrical standoffs between board and motor. The standoffs should be about 2.5mm long. The PCB should fit completely behind the motor.</li><li>Connect the motor&#x27;s electrical connections (coils) to the PCB via screw terminal blocks. A and B labels correspond to the 2 coils in the motor.</li><li>Connect it to a 12V supply and CAN via JST XH 4-pin connector</li><li>The PCB controls the motor with a TMC2209 stepper motor driver</li><li>A magnetometer on the PCB measures axle position and supply feedback for accurate positioning</li><li>A XIAO ESP32S3 plugged in to the PCB can accept high-level commands (go to a position) and handle autonomous homing and stepping control (low level control of the stepper motor driver)</li><li>The high-level interface can supply information about motor load, command success/status, fail state, etc.</li><li>Endstop can be connected to a XIAO pin, 3.3V and GND with JST ZH 3-pin connector.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pinout">Pinout<a class="hash-link" href="#pinout" title="Direct link to heading">​</a></h3><p>The different XIAO models connect to different ESP GPIOs, and strapping pins, pins with glitches or pins with default pullups/pulldowns may be different between ESP models in the XIAO format.</p><table><thead><tr><th>XIAO pin</th><th>Function</th></tr></thead><tbody><tr><td>D0</td><td>Endstop</td></tr><tr><td>D1</td><td>CAN Receive / SCL on old bus</td></tr><tr><td>D2</td><td>CAN Send / SDA on old bus</td></tr><tr><td>D3</td><td>Motor driver DIAG output</td></tr><tr><td>D4</td><td>I2C SDA to encoder</td></tr><tr><td>D5</td><td>I2C SCL to encoder</td></tr><tr><td>D6</td><td>UART send to motor driver</td></tr><tr><td>D7</td><td>UART recv from motor driver</td></tr><tr><td>D8</td><td>Motor direction</td></tr><tr><td>D9</td><td>Motor step</td></tr><tr><td>D10</td><td>Motor driver enable</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="current-sensing-and-current-setting">Current sensing and current setting<a class="hash-link" href="#current-sensing-and-current-setting" title="Direct link to heading">​</a></h3><p>Rsense (or R_SENSE) is <strong>0.2 Ohm</strong>. This is the value of the sense resistance connected to BRA and BRB of the TMC2209.</p><p>The current limit can be set by setting the <strong>Vsense</strong> value in the TMC, which is the sensitivity of the current measurement. Setting this, with the 0.2 Ohms of actual resistance on stepper-backpacker, yields:</p><ul><li>Vsense=0 (low sensitivity curr sense setting): 1.4A peak, 1A RMS</li><li>Vsense=1: 0.8A peak, 0.55A RMS</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="converting-rev-c-from-12vcan-to-5vi2c">Converting Rev. C from 12V+CAN to 5V+I2C<a class="hash-link" href="#converting-rev-c-from-12vcan-to-5vi2c" title="Direct link to heading">​</a></h3><p>Make sure there are pullups (4.7k) to 3.3V somewhere on both I2C lines.</p><p>Use the ibom.html to find the correct solderjumpers on the board.</p><p>Close JP jumpers by making a solder bridge between the 2 pads. Open R 0-resistors by unsoldering them or snapping them with pliers.</p><table><thead><tr><th>Operation</th><th>Effect</th></tr></thead><tbody><tr><td>Close JP102</td><td>CANBUS_P connects directly to XIAO GPIO (as I2C-1_SDA)</td></tr><tr><td>Close JP103</td><td>CANBUS_N connects directly to XIAO GPIO (as I2C1_SCL)</td></tr><tr><td>Close JP501</td><td>Connects CAN transceiver Rs to 3.3V to STBY transmitter driver</td></tr><tr><td>Open R502</td><td>Disconnect still-active CAN receiver oupoutput from XIAO pin D1</td></tr><tr><td>Open R501</td><td>Disconnects CAN transceiver VCC power input from 3.3V</td></tr><tr><td>Close JP101</td><td>Connects 12V and 5V power nets (Warning: Do not connect 12V when closed)</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="terminating-canbus-or-activating-can-activity-indicator-led">Terminating CANBUS or activating CAN activity indicator LED<a class="hash-link" href="#terminating-canbus-or-activating-can-activity-indicator-led" title="Direct link to heading">​</a></h3><table><thead><tr><th>Operation</th><th>Effect</th></tr></thead><tbody><tr><td>Close JP502</td><td>Terminates CANBUS on the board by connecting CAN_H and CAN_L through 120 Ohm resistor</td></tr><tr><td>Close JP503</td><td>Red LED D501 lights when CAN bus is in dominant state (logical 0, lines at different voltages)</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="laser-interface">Laser-interface<a class="hash-link" href="#laser-interface" title="Direct link to heading">​</a></h2><p>This board can control a laser or LEDs and has 4 channels. It connects to the XH_12V+CAN backbone, has a XIAO to accept CAN commands and generate PWM signals, and has connectors for interlock sources. The interface to the laser is 4x PWM signal between 0V and 3.3V (LO should mean off), and 12V power.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xiao-pinout">XIAO pinout<a class="hash-link" href="#xiao-pinout" title="Direct link to heading">​</a></h3><p>I is intended as input to the XIAO. O is intended as output.</p><table><thead><tr><th>XIAO pin</th><th>XIAO ESP32S3 pin</th><th>Board Function</th></tr></thead><tbody><tr><td>D0</td><td>GPIO_01</td><td>I: LO when interlock tripped (enable pullup), O: pull LO to light keyswitch-LED</td></tr><tr><td>D1</td><td>GPIO_02</td><td>O: signal_1</td></tr><tr><td>D2</td><td>GPIO_03</td><td>O: signal_2</td></tr><tr><td>D3</td><td>GPIO_04</td><td>O: CAN-SEND</td></tr><tr><td>D4</td><td>GPIO_05</td><td>O: signal_3</td></tr><tr><td>D5</td><td>GPIO_06</td><td>O: signal_4</td></tr><tr><td>D6</td><td>U0TXD/GPIO_43</td><td>Unused, available on J1101</td></tr><tr><td>D7</td><td>U0RXD/GPIO_44</td><td>Unused, available on J1101</td></tr><tr><td>D8</td><td>GPIO_07</td><td>Unused, available on J1101</td></tr><tr><td>D9</td><td>GPIO_08</td><td>I: LO when interlock has power (keyswitch in ON position)</td></tr><tr><td>D10</td><td>GPIO_09</td><td>I: CAN-RECV</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="keyswitch-specifications-and-connections">Keyswitch specifications and connections<a class="hash-link" href="#keyswitch-specifications-and-connections" title="Direct link to heading">​</a></h3><p>J102 is a 3-pin screw terminal to connect a key-switch and a red LED.</p><p>The key-switch should be a single-pole single-throw key-operated switch where the key can only be removed in OFF position. It switches less than 1 mA at 3.3V. In the ON position, the switch should connect pin 2 and 3 of J102.</p><p>The LED indicates when the interlock has triggered and the user needs to reset the interlock by turning off and on the keyswitch. It has 200 Ohms in series at 3.3V, so a red LED will be driven with around 7 mA. An ESP GPIO can light this LED at half current. The red LED on the board close to the output terminal has the same states as the external LED. An LED should directly be connected to J102 with Anode (+) on pin 2, and Cathode (-) on pin 1.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="interlock">Interlock<a class="hash-link" href="#interlock" title="Direct link to heading">​</a></h3><p>The interlocks ensure that a signal can only pass from the ESP to the laser if:</p><ul><li>The keyswitch is in the ON position</li><li>12V power is stable (aka Emergency-stop not pushed)</li><li>A magnet switch is closed indicating that something like a laser-safety hood is covering the device</li><li>An endstop or optical endstop is pressed indicating that the modules are fully inserted, the hood is closed, etc.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="interlock-behavior-and-status-inticators">Interlock behavior and status inticators<a class="hash-link" href="#interlock-behavior-and-status-inticators" title="Direct link to heading">​</a></h4><p>The interlock has to be powered on by turning the keyswitch ON. It will then watch all the interlock sources, and trigger if one of the sources has an unsafe state.</p><p>If the interlock has been triggered, it will stop transmitting any signal to the laser, and the red LED by the keyswitch and by the output terminals will be lit. The interlock will stay triggered until it is reset by turning the keyswitch OFF and ON again.</p><p>If the interlock is active and not triggered, signals from the ESP (signal_1-4) will be transmitted to the output terminal block. Probably only binary signals like PWM will work. If the interlock is transmitting, the green LED by the output terminals will be lit, but the red LED next to it will not be lit.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="interlock-sources">Interlock sources<a class="hash-link" href="#interlock-sources" title="Direct link to heading">​</a></h4><p><strong>Keyswitch (J102)</strong>: The keyswitch switches power to the latch circuit of the signals interlock. If this is ON, the green LED close to the output terminals will be lit.</p><p><strong>12V-OK (internal)</strong>: The 12V input has to stay above 11.3V. If power falls below that, the 12V power to the laser will be turned off, and the interlock for the signals will be triggered. This enables early detection when the Emergency Stop has been pressed and the power is interrupted. When the 12V to the laser is ON, the green LED below the XIAO will be lit.</p><p><strong>Endstop (J103)</strong>: The 3-pin screw terminal J103 provides GND, signal, and 3.3V. The signal has to be HI for normal operation, like when the modules are fully inserted or when the safety hood is closed. If the signal pin is LO or floating, it will trigger the interlock. Because there is constant 3.3V and GND available, optical endstops can be used.</p><p><strong>Magnet Switch (J104)</strong>: On the 2-pin screw terminal J104, a simple magnet switch (reed switch) or other simple switch can be connected. The switch should close in the presence of a magnet, and be open otherwise. For normal operation, a magnet can be fixed to the safety hood, and the switch in the base where the magnet will be close if the hood is closed (safe). Other switches can also be used. When the contacts are closed (shorted), it is safe, and when the switch is opened, the interlock triggers.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="interlock-overrides">Interlock overrides<a class="hash-link" href="#interlock-overrides" title="Direct link to heading">​</a></h4><p>Parts of the interlock can be deactivated so that no condition at this interlock source will trigger the interlock. This way, the laser-interface can be configured to the types of safety devices available, when it is integrated into a microscope.</p><p>To override parts of the interlock, turn on one or multiple switches inside the dipswitch <strong>SW701</strong> to the side labeled ON. This will close the switch and assume SAFE regardless of the actual state of the interlock source. No state on the respective interlock source will trigger the interlock.</p><p>The individual switches of the dipswitch are numbered. All interlock sources are active if all switches are OFF (set to the side opposite of the side labeled ON).</p><table><thead><tr><th>SW701 switch number</th><th>effect when ON</th></tr></thead><tbody><tr><td>1</td><td>Magnet switch J104 overridden</td></tr><tr><td>2</td><td>12V-OK interlock triggering overridden and 12V output to laser always ON</td></tr><tr><td>3</td><td>Hood Endstop switch J103 overridden</td></tr><tr><td>4</td><td>Overrides whole interlock including keyswitch. Signals will always be passed, but 12V-OK still switches laser power</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="solderjumpers">Solderjumpers<a class="hash-link" href="#solderjumpers" title="Direct link to heading">​</a></h3><table><thead><tr><th>Operation</th><th>Effect</th></tr></thead><tbody><tr><td>Close JP301</td><td>Terminates CANBUS on the board by connecting CAN_H and CAN_L through 120 Ohm resistor</td></tr><tr><td>Close JP302</td><td>Red LED D501 lights when CAN bus is in dominant state (logical 0, lines at different voltages)</td></tr><tr><td>Close JP1101</td><td>Add 4.7k pullup on D6</td></tr><tr><td>Close JP1102</td><td>Add 4.7k pullup on D7</td></tr><tr><td>Close JP1103</td><td>Add 4.7k pullup on D8</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-board-as-can-to-gpio-converter">Using the board as CAN-to-GPIO converter<a class="hash-link" href="#using-the-board-as-can-to-gpio-converter" title="Direct link to heading">​</a></h3><p>J1101 is a 9-pin screw terminal connected to the ESP/XIAO pins (before the interlocks), 12V and GND. The 12V is not switched. Signals 1-4 have always-connected pulldown resistors, D6-D8 have optional pullup resistors that can be enabled by closing solderjumpers.</p><table><thead><tr><th>Screw terminal pin</th><th>connection</th><th>pullup/pulldown</th></tr></thead><tbody><tr><td>1</td><td>GND</td><td></td></tr><tr><td>2</td><td>12V</td><td></td></tr><tr><td>3</td><td>D1/signal_1</td><td>down 4.7k</td></tr><tr><td>4</td><td>D2/signal_2</td><td>down 4.7k</td></tr><tr><td>5</td><td>D4/signal_3</td><td>down 4.7k</td></tr><tr><td>6</td><td>D5/signal_4</td><td>down 4.7k</td></tr><tr><td>7</td><td>D6</td><td>up 4.7k when closing JP1101</td></tr><tr><td>8</td><td>D7</td><td>up 4.7k when closing JP1102</td></tr><tr><td>9</td><td>D8</td><td>up 4.7k when closing JP1103</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pogopin-connectors">Pogopin-connectors<a class="hash-link" href="#pogopin-connectors" title="Direct link to heading">​</a></h2><p>Pogo pins are spring-loaded contacts. They will enable a module to automatically make electrical connections to the mainboard when it is inserted into the microscope.</p><ul><li>The boards have to be worked on in pairs so that the pins (M) align with the contact pads (F) and have the expected pinout.</li><li>The boards need to be pressed and held together for the pins to make proper contact. The datasheet of the used pins specifies their optimal/minimum/maximum depress distance and spring force.</li><li>The pogo pins have a current capibility of 1A per pin. For power transmission 12V is used over the pins and converted down (DC-DC converter) on the board with the device that needs it.</li><li>I2C is also passed via the pins. The module is a peripheral to the controller on the mainboard.</li><li>The pogo pins can break off easily if the tips experience force to the sides. The pins should therefore be protected.  They can be placed in the part inside the microscope protected from touching. The connector part with the pads can be on the outside of the modules.</li><li>The connector boards use wire-to-board connectors with the same type (XH) and pinout as the &quot;to-motherboard&quot; connector of the stepper backpack. GND, 12V, SDA, SCL</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Electronics/StepperMotorBackpack"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Documentation for Stepper Motor Controller with Rotational Encoder (TMC2209 + AS5600)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Electronics/RaspberryPiHat+"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">HAT+</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#canbus-as-communication-between-devices" class="table-of-contents__link toc-highlight">CANBUS as communication between devices</a></li><li><a href="#hatplus-for-raspberrypi-5" class="table-of-contents__link toc-highlight">hatplus-for-raspberrypi-5</a><ul><li><a href="#raspberry-pi-hat-implementation-eeproms-hat-spec" class="table-of-contents__link toc-highlight">Raspberry Pi HAT+ implementation (EEPROMS, HAT+ spec)</a></li><li><a href="#raspberry-pi-pinout" class="table-of-contents__link toc-highlight">Raspberry Pi pinout</a></li><li><a href="#esp32-pinout" class="table-of-contents__link toc-highlight">ESP32 pinout</a></li><li><a href="#emergency-stop-connector" class="table-of-contents__link toc-highlight">Emergency STOP connector</a></li><li><a href="#hat-terminating-canbus-or-activating-can-activity-indicator-led" class="table-of-contents__link toc-highlight">HAT: Terminating CANBUS or activating CAN activity indicator LED</a></li><li><a href="#disabling-communication-or-power-switching-functions" class="table-of-contents__link toc-highlight">Disabling communication or power-switching functions</a></li></ul></li><li><a href="#stepper-backpack" class="table-of-contents__link toc-highlight">stepper-backpack</a><ul><li><a href="#pinout" class="table-of-contents__link toc-highlight">Pinout</a></li><li><a href="#current-sensing-and-current-setting" class="table-of-contents__link toc-highlight">Current sensing and current setting</a></li><li><a href="#converting-rev-c-from-12vcan-to-5vi2c" class="table-of-contents__link toc-highlight">Converting Rev. C from 12V+CAN to 5V+I2C</a></li><li><a href="#terminating-canbus-or-activating-can-activity-indicator-led" class="table-of-contents__link toc-highlight">Terminating CANBUS or activating CAN activity indicator LED</a></li></ul></li><li><a href="#laser-interface" class="table-of-contents__link toc-highlight">Laser-interface</a><ul><li><a href="#xiao-pinout" class="table-of-contents__link toc-highlight">XIAO pinout</a></li><li><a href="#keyswitch-specifications-and-connections" class="table-of-contents__link toc-highlight">Keyswitch specifications and connections</a></li><li><a href="#interlock" class="table-of-contents__link toc-highlight">Interlock</a></li><li><a href="#solderjumpers" class="table-of-contents__link toc-highlight">Solderjumpers</a></li><li><a href="#using-the-board-as-can-to-gpio-converter" class="table-of-contents__link toc-highlight">Using the board as CAN-to-GPIO converter</a></li></ul></li><li><a href="#pogopin-connectors" class="table-of-contents__link toc-highlight">Pogopin-connectors</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://youseetoo.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discourse<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/OpenUc2" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/openuc2/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 openUC2.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.482c0bff.js"></script>
<script src="/assets/js/main.35ca945d.js"></script>
</body>
</html>