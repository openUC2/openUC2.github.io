<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/scripting_engine___imscripting____imnotebook___">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Chapter 4: Scripting Engine (`imscripting`, `imnotebook`) | openUC2 Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.youseetoo.org/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/scripting_engine___imscripting____imnotebook___"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Chapter 4: Scripting Engine (`imscripting`, `imnotebook`) | openUC2 Documentation"><meta data-rh="true" name="description" content="In the previous chapter, we learned about the GUI Toolkit (guitools) which provides the buttons, sliders, and windows you use to interact with ImSwitch manually. Clicking buttons is great for simple tasks, but what if you need to do something complex or repeat a sequence of actions many times?"><meta data-rh="true" property="og:description" content="In the previous chapter, we learned about the GUI Toolkit (guitools) which provides the buttons, sliders, and windows you use to interact with ImSwitch manually. Clicking buttons is great for simple tasks, but what if you need to do something complex or repeat a sequence of actions many times?"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.youseetoo.org/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/scripting_engine___imscripting____imnotebook___"><link data-rh="true" rel="alternate" href="https://docs.youseetoo.org/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/scripting_engine___imscripting____imnotebook___" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.youseetoo.org/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/scripting_engine___imscripting____imnotebook___" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://DB3UCAMZ89-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="openUC2 Documentation" href="/opensearch.xml">

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>var pdfData={};const getBaseUrl=function(n){return"/"},getDownloadItems=function(){for(var n,e=[],t=pdfData[(n=document.location.pathname,n.endsWith("/")?n.slice(0,-1):n)]||[],o=0,l=t.length;o<l;o++)"root"!==t[o].type?"section"!==t[o].type?"chapter"===t[o].type&&e.push({title:"Download page: <br/> <strong style=font-size:16px>"+t[o].label+"</strong>",path:"/"+t[o].file}):e.push({title:"Download section: <br/> <strong style=font-size:16px>"+t[o].label+"</strong>",path:"/"+t[o].file}):e.push({title:"Download complete version: <br/> <strong style=font-size:16px>"+t[o].label+"</strong>",path:"/"+t[o].file});return e},fillDownloadDropdownMenu=function(){$("#pdfDownloadMenuList").empty();const n=getDownloadItems();var e="";n.forEach((function(n){e+="<li>",e+='<a class="dropdown__link" href="'+n.path+'" download>'+n.title+"</a>",e+="</li>"})),0===e.length&&(e="<li>No PDF downloads on this page</li>"),$("#pdfDownloadMenuList").append(e)},fillDownloadSidebarMenu=function(){$("#pdfLinkSidebarMenu").empty();const n=getDownloadItems();var e="";n.forEach((function(n){e+='<li class="menu__list-item">',e+='<a class="menu__link" href="'+n.path+'" download>'+n.title+"</a>",e+="</li>"})),0===e.length&&(e="<li>No PDF downloads on this page</li>"),$("#pdfLinkSidebarMenu").append(e)},checkAndInsertPdfButtons=function(){if($("html").hasClass("plugin-docs")){if(!$("#pdfLink").length){var n=$('<div class="navbar__item dropdown dropdown--hoverable dropdown--right" id="pdfDownloadMenu">  <a class="navbar__item navbar__link pdfLink" id="pdfLink" href="#">Download as PDF</a>  <ul class="dropdown__menu" id="pdfDownloadMenuList"></ul></div>');$(".navbar__items--right").prepend(n),$("#pdfDownloadMenu").mouseenter(fillDownloadDropdownMenu)}if(!$("#pdfLinkSidebar").length){var e=$('<li class="menu__list-item menu__list-item--collapsed" id="pdfLinkSidebar"><a role="button" class="menu__link menu__link--sublist">Download as PDF</a><ul class="menu__list" id="pdfLinkSidebarMenu" style=""></ul></li>');$(".navbar-sidebar__items > .menu > .menu__list").append(e),$("#pdfLinkSidebar").click((function(){$("#pdfLinkSidebar").toggleClass("menu__list-item--collapsed")})),$(".navbar__toggle").click(fillDownloadSidebarMenu)}}};$(window).on("load",(function(){fetch("/pdfs.json").then((n=>n.json())).then((function(n){pdfData=n,checkAndInsertPdfButtons(),setInterval(checkAndInsertPdfButtons,1e3)}))}))</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.e4f4e440.css">
<link rel="preload" href="/assets/js/runtime~main.339fef12.js" as="script">
<link rel="preload" href="/assets/js/main.752e8aa7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Artboard4@4x.png" alt="openUC2 Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/Artboard4@4x.png" alt="openUC2 Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">openUC2 Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openuc2/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/General/ModuleDeveloperKit/">General</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Toolboxes/">Discovery Boxes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Discovery Boxes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Investigator/">Professional Line</a><button aria-label="Toggle the collapsible sidebar category &#x27;Professional Line&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Electronics/Quickstart">Electronics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/ImSwitch/Quickstart">ImSwitch</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ImSwitch/Quickstart">Quickstart Guide: Using Raspberry Pi with ImSwitch and UC2-ESP</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/ImSwitch/Advanced/">ImSwitch Advanced Documentation</a><button aria-label="Toggle the collapsible sidebar category &#x27;ImSwitch Advanced Documentation&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ImSwitch/Advanced/Installation/">ImSwitch Installation Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;ImSwitch Installation Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ImSwitch/Advanced/Usage/">ImSwitch Usage Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;ImSwitch Usage Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ImSwitch/Advanced/Configuration/">ImSwitch Configuration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ImSwitch/Advanced/Tutorials/">ImSwitch Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;ImSwitch Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ImSwitch/Advanced/Device-Specific/">Device-Specific Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Device-Specific Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/ImSwitch/Advanced/Experimental/">Experimental Features</a><button aria-label="Toggle the collapsible sidebar category &#x27;Experimental Features&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/">Tutorial: ImSwitch</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial: ImSwitch&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/hardware_control_hub___imcontrol___">Chapter 1: Hardware Control Hub (`imcontrol`)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/image_reconstruction_pipeline___imreconstruct___">Chapter 2: Image Reconstruction Pipeline (`imreconstruct`)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/gui_toolkit___guitools___">Chapter 3: GUI Toolkit (`guitools`)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/scripting_engine___imscripting____imnotebook___">Chapter 4: Scripting Engine (`imscripting`, `imnotebook`)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/device_interfaces___imcontrol_model_interfaces___">Chapter 5: Device Interfaces (`imcontrol/model/interfaces`)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/data_objects___imreconstruct_model___">Chapter 6: Data Objects (`imreconstruct/model`)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/model_view_controller__mvc__pattern_components_">Chapter 7: Model-View-Controller (MVC) Pattern Components</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ImSwitch/Advanced/Experimental/Headless-Mode">ImSwitch Experimental Features Documentation</a></li></ul></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/WORKSHOPS/">openUC2 Workshops</a><button aria-label="Toggle the collapsible sidebar category &#x27;openUC2 Workshops&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Misc/MultiarrayMicroscope/">Misc</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/ARCHIVE/ZMicroscope/UpackZMicroscope">ARCHIVE</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">ImSwitch</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/ImSwitch/Advanced/"><span itemprop="name">ImSwitch Advanced Documentation</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/ImSwitch/Advanced/Experimental/"><span itemprop="name">Experimental Features</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/"><span itemprop="name">Tutorial: ImSwitch</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Chapter 4: Scripting Engine (`imscripting`, `imnotebook`)</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Chapter 4: Scripting Engine (<code>imscripting</code>, <code>imnotebook</code>)</h1><p>In the previous chapter, we learned about the <a href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/gui_toolkit___guitools___">GUI Toolkit (<code>guitools</code>)</a> which provides the buttons, sliders, and windows you use to interact with ImSwitch manually. Clicking buttons is great for simple tasks, but what if you need to do something complex or repeat a sequence of actions many times?</p><p>Imagine you want to test how your sample looks under different conditions. Maybe you need to take an image with Laser A at 10% power, then 20%, then 30%, all the way up to 100%. Then maybe repeat the whole process with Laser B! Doing this manually by clicking buttons and adjusting sliders over and over would be very time-consuming and you might even make mistakes.</p><p>This is where the <strong>Scripting Engine (<code>imscripting</code>, <code>imnotebook</code>)</strong> comes to the rescue!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-problem-does-the-scripting-engine-solve">What Problem Does the Scripting Engine Solve?<a class="hash-link" href="#what-problem-does-the-scripting-engine-solve" title="Direct link to heading">​</a></h2><p>The main challenge is <strong>automating complex or repetitive tasks</strong>. Manually controlling the microscope for long experiments or complex sequences is tedious, slow, and prone to human error.</p><p><strong>Use Case Example: Automated Laser Power Test</strong></p><p>Let&#x27;s stick with our example: taking images of a sample using Laser A at various power levels (10%, 20%, ..., 100%).</p><ol><li><p><strong>Manual Way:</strong></p><ul><li>Set Laser A power to 10%.</li><li>Click &quot;Snap&quot; to take an image.</li><li>Wait. Save the image.</li><li>Set Laser A power to 20%.</li><li>Click &quot;Snap&quot;.</li><li>Wait. Save the image.</li><li>... repeat 8 more times ... (Ugh!)</li></ul></li><li><p><strong>Scripting Way:</strong></p><ul><li>Write a short script (a set of instructions) that tells ImSwitch: &quot;Loop through powers 10% to 100% in steps of 10%. In each step, set Laser A power to the current value, then take a picture.&quot;</li><li>Run the script.</li><li>Go grab a coffee while ImSwitch automatically performs all 10 steps perfectly!</li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="imscripting-your-experiment-recipe-book"><code>imscripting</code>: Your Experiment Recipe Book<a class="hash-link" href="#imscripting-your-experiment-recipe-book" title="Direct link to heading">​</a></h2><p>Think of the Scripting Engine like writing a <strong>recipe</strong> or a <strong>playbook</strong>.</p><ul><li><strong>Recipe:</strong> Instead of standing in the kitchen and deciding each step as you go (manual control), you write down the entire recipe beforehand: &quot;Preheat oven to 350°F, mix flour and sugar, add eggs...&quot; (<code>imscripting</code> lets you write the recipe). Then, the oven and mixer follow your instructions automatically (ImSwitch executes the script).</li><li><strong>Playbook (Sports):</strong> Instead of the coach shouting individual instructions during the game (manual control), the team practices specific plays written in a playbook (<code>imscripting</code>). When the coach calls &quot;Play #7&quot;, everyone knows exactly what sequence of actions to perform automatically (ImSwitch executes the script).</li></ul><p><strong><code>imscripting</code></strong> is the core part of ImSwitch that lets you write these &quot;recipes&quot; or &quot;plays&quot; using the Python programming language. You write code to tell ImSwitch exactly what sequence of actions to perform.</p><p><strong><code>imnotebook</code></strong> is a special flavor that integrates this scripting capability directly into <strong>Jupyter Notebooks</strong>. Jupyter notebooks are fantastic tools used by scientists and data analysts because they let you mix code, explanatory text, images, and results all in one document. Using <code>imnotebook</code>, you can control your microscope, acquire data, analyze it, and document the whole process interactively within a notebook environment.</p><p>In essence, the Scripting Engine provides a way to <strong>programmatically control ImSwitch</strong>, automating experiments and analysis using Python code.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-scripting-work-a-simple-example">How Does Scripting Work? A Simple Example<a class="hash-link" href="#how-does-scripting-work-a-simple-example" title="Direct link to heading">​</a></h2><p>Scripts are just text files containing Python code. Inside the script, you can use special functions provided by ImSwitch to interact with the different parts of the system we&#x27;ve learned about:</p><ul><li>You can tell the <a href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/hardware_control_hub___imcontrol___">Hardware Control Hub (<code>imcontrol</code>)</a> to turn on lasers, move the stage, or snap images.</li><li>You can potentially trigger processing in the <a href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/image_reconstruction_pipeline___imreconstruct___">Image Reconstruction Pipeline (<code>imreconstruct</code>)</a>.</li><li>You can perform calculations, save data, or print messages.</li></ul><p>Let&#x27;s write a very simple script to solve our &quot;Automated Laser Power Test&quot; use case:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># A simple ImSwitch script (conceptual example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Get access to the hardware controls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imcontrol </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_imcontrol_api</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Define the laser we want to use</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">laser_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;LaserA&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Loop through power levels from 10 to 100, in steps of 10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> power </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">101</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Setting </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">laser_name</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> power to </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">power</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">%&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imcontrol</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_laser_power</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">laser_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> power</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Taking image at </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">power</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">% power...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imcontrol</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">snap_image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Tells the camera to take one picture</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Optional: Add a small pause if needed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># time.sleep(0.5) # Wait for half a second</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Automated laser test finished!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Explanation:</strong></p><ol><li><code>imcontrol = get_imcontrol_api()</code>: This line (conceptually) gives your script access to the functions that control the hardware, like setting laser power or taking pictures.</li><li><code>laser_name = &quot;LaserA&quot;</code>: We store the name of the laser we want to control in a variable.</li><li><code>for power in range(10, 101, 10):</code>: This is a standard Python loop. It creates a variable <code>power</code> that will take the values 10, 20, 30, ..., up to 100.</li><li><code>print(...)</code>: This just displays messages on the screen so you can see what the script is doing.</li><li><code>imcontrol.set_laser_power(laser_name, power)</code>: This is the key command! It tells the <a href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/hardware_control_hub___imcontrol___">Hardware Control Hub (<code>imcontrol</code>)</a> to find the laser named &quot;LaserA&quot; and set its power to the current value of the <code>power</code> variable.</li><li><code>imcontrol.snap_image()</code>: This command tells <code>imcontrol</code> to trigger the connected camera to take a single picture (a &quot;snap&quot;).</li><li>The loop repeats for each power level.</li><li><code>print(&quot;Automated laser test finished!&quot;)</code>: A final message when the script is done.</li></ol><p>When you run this script within ImSwitch (using <code>imscripting</code>), it will automatically execute these steps one by one, precisely controlling the laser and camera for you! If you were using <code>imnotebook</code>, you could run this exact code block within a Jupyter cell.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-glimpse-under-the-hood">A Glimpse Under the Hood<a class="hash-link" href="#a-glimpse-under-the-hood" title="Direct link to heading">​</a></h2><p>How does ImSwitch actually run your script and connect it to the hardware?</p><p><strong>Conceptual Flow:</strong></p><ol><li><strong>You Write:</strong> You create your Python script (like the example above).</li><li><strong>You Run:</strong> You tell ImSwitch (either through its GUI or a Jupyter notebook) to execute your script.</li><li><strong>Engine Reads:</strong> The Scripting Engine (<code>imscripting</code>) reads your Python code.</li><li><strong>Executor Runs:</strong> A component called the <code>ScriptExecutor</code> starts running your code line by line.</li><li><strong>API Calls:</strong> When the executor encounters a command like <code>imcontrol.set_laser_power(...)</code>, it doesn&#x27;t execute it directly. Instead, it calls the actual function provided by the <a href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/hardware_control_hub___imcontrol___">Hardware Control Hub (<code>imcontrol</code>)</a>.</li><li><strong><code>imcontrol</code> Acts:</strong> <code>imcontrol</code> receives the request (e.g., &quot;set LaserA power to 20&quot;) and performs the necessary actions, possibly communicating with the specific <a href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/device_interfaces___imcontrol_model_interfaces___">Device Interfaces (<code>imcontrol/model/interfaces</code>)</a> for that laser (as discussed in Chapter 1).</li><li><strong>Hardware Responds:</strong> The physical laser changes its power output.</li><li><strong>Loop Continues:</strong> The <code>ScriptExecutor</code> moves to the next line of your script (e.g., <code>imcontrol.snap_image()</code>), makes the corresponding call to <code>imcontrol</code>, and so on, until the script finishes.</li></ol><p>Here&#x27;s a simplified sequence diagram:</p><div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sequenceDiagram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant User</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ScriptEng as Scripting Engine (imscripting)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant ScriptExec as ScriptExecutor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant IC as imcontrol (API)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    participant Hardware</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User-&gt;&gt;ScriptEng: Run Script &#x27;laser_test.py&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ScriptEng-&gt;&gt;ScriptExec: Execute code: set_laser_power(&#x27;LaserA&#x27;, 10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ScriptExec-&gt;&gt;IC: Call set_laser_power(&#x27;LaserA&#x27;, 10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IC-&gt;&gt;Hardware: Send command to Laser A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Hardware--&gt;&gt;IC: Acknowledge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IC--&gt;&gt;ScriptExec: Power set OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ScriptEng-&gt;&gt;ScriptExec: Execute code: snap_image()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ScriptExec-&gt;&gt;IC: Call snap_image()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IC-&gt;&gt;Hardware: Send command to Camera</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Hardware--&gt;&gt;IC: Acknowledge (Image starts acquiring)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IC--&gt;&gt;ScriptExec: Snap initiated OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Note right of ScriptExec: Script continues (loops, etc.)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Code Structure:</strong></p><p>The main components involved are:</p><ul><li><code>imswitch/imscripting/controller/ImScrMainController.py</code>: This acts as the main coordinator for the scripting functionality, managing scripts and triggering their execution.</li><li><code>imswitch/imscripting/model/ScriptExecutor.py</code>: This is the core component responsible for actually running the Python script code in a controlled environment.</li><li><code>imswitch/imscripting/model/ScriptStore.py</code>: Helps manage saved scripts.</li><li><code>imswitch/imscripting/model/actions.py</code>: This is crucial! It defines the specific functions (like our conceptual <code>get_imcontrol_api()</code> or the real underlying functions for <code>set_laser_power</code>, <code>snap_image</code>, etc.) that are made available (&quot;exposed&quot;) to your scripts. It acts as the bridge between your simple script commands and the powerful capabilities of modules like <code>imcontrol</code> and <code>imreconstruct</code>.</li></ul><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Conceptual look inside actions.py or similar setup code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Import the actual controller from imcontrol</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> imswitch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">imcontrol</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">controller </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ImConMainController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Get the running instance of the imcontrol controller</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># (How this happens depends on the application structure)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imcontrol_controller </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_running_imcontrol_instance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Define functions that scripts can call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">script_set_laser_power</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Script action: Setting laser </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">name</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> to </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">value</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imcontrol_controller</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_manager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;lasers&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_power</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">script_snap_image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Script action: Snapping image&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imcontrol_controller</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_manager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;detectors&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">snap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Make these functions available to the ScriptExecutor under friendly names</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># The ScriptExecutor would be configured to know that when a script calls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># &#x27;imcontrol.set_laser_power&#x27;, it should run &#x27;script_set_laser_power&#x27;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">actions_scope </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;imcontrol&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;set_laser_power&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> script_set_laser_power</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;snap_image&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> script_snap_image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># ... other functions ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Potentially actions for imreconstruct, file saving, etc.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This conceptual code shows how functions like <code>script_set_laser_power</code> are defined internally. These functions take the simple arguments from your script (<code>name</code>, <code>value</code>) and then call the more detailed methods within the actual controllers (like <code>imcontrol_controller.get_manager(&quot;lasers&quot;).set_power(...)</code>). The <code>ScriptExecutor</code> uses this <code>actions_scope</code> mapping to connect the commands in your script to the real ImSwitch functionality.</p><p>The <code>imnotebook</code> module (<code>imswitch/imnotebook/</code>) essentially adapts this scripting engine to work smoothly within the Jupyter environment, often involving setting up a communication channel between the main ImSwitch application and the Jupyter kernel.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">​</a></h2><p>You&#x27;ve now learned about the <strong>Scripting Engine (<code>imscripting</code>, <code>imnotebook</code>)</strong>, which empowers you to automate complex sequences of actions in ImSwitch. By writing simple Python scripts, you can create recipes or playbooks for your experiments, making them more efficient, reproducible, and less prone to error. We saw how scripts can call functions to control hardware via the <a href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/hardware_control_hub___imcontrol___">Hardware Control Hub (<code>imcontrol</code>)</a> and how <code>imnotebook</code> brings this power into the flexible Jupyter environment.</p><p>We&#x27;ve mentioned controlling hardware like lasers and cameras quite a bit. But how does ImSwitch know how to talk to <em>your specific model</em> of laser or camera?</p><p>Let&#x27;s dive into the details of how ImSwitch communicates with individual hardware pieces in the next chapter: <a href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/device_interfaces___imcontrol_model_interfaces___">Chapter 5: Device Interfaces (<code>imcontrol/model/interfaces</code>)</a>.</p><hr><p>Generated by <a href="https://github.com/The-Pocket/Tutorial-Codebase-Knowledge" target="_blank" rel="noopener noreferrer">AI Codebase Knowledge Builder</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/gui_toolkit___guitools___"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Chapter 3: GUI Toolkit (`guitools`)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/ImSwitch/Advanced/Experimental/Auto-Generated-Tutorials/device_interfaces___imcontrol_model_interfaces___"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Chapter 5: Device Interfaces (`imcontrol/model/interfaces`)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-problem-does-the-scripting-engine-solve" class="table-of-contents__link toc-highlight">What Problem Does the Scripting Engine Solve?</a></li><li><a href="#imscripting-your-experiment-recipe-book" class="table-of-contents__link toc-highlight"><code>imscripting</code>: Your Experiment Recipe Book</a></li><li><a href="#how-does-scripting-work-a-simple-example" class="table-of-contents__link toc-highlight">How Does Scripting Work? A Simple Example</a></li><li><a href="#a-glimpse-under-the-hood" class="table-of-contents__link toc-highlight">A Glimpse Under the Hood</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://youseetoo.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discourse<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/OpenUc2" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/openuc2/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 openUC2.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.339fef12.js"></script>
<script src="/assets/js/main.752e8aa7.js"></script>
</body>
</html>