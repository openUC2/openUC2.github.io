<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Electronics/UC2-ESP/UC2_Firmware_Description">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">UC2-ESP32 Firmware Documentation | openUC2 Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.youseetoo.org/docs/Electronics/UC2-ESP/UC2_Firmware_Description"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="UC2-ESP32 Firmware Documentation | openUC2 Documentation"><meta data-rh="true" name="description" content="Welcome to the UC2-ESP32 firmware documentation! This guide provides detailed information on using, configuring, and extending the UC2-ESP32 firmware to control a microscope via USB Serial, Bluetooth, and WiFi using an ESP32 microcontroller. The firmware is modular, allowing easy customization for various hardware setups and requirements."><meta data-rh="true" property="og:description" content="Welcome to the UC2-ESP32 firmware documentation! This guide provides detailed information on using, configuring, and extending the UC2-ESP32 firmware to control a microscope via USB Serial, Bluetooth, and WiFi using an ESP32 microcontroller. The firmware is modular, allowing easy customization for various hardware setups and requirements."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.youseetoo.org/docs/Electronics/UC2-ESP/UC2_Firmware_Description"><link data-rh="true" rel="alternate" href="https://docs.youseetoo.org/docs/Electronics/UC2-ESP/UC2_Firmware_Description" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.youseetoo.org/docs/Electronics/UC2-ESP/UC2_Firmware_Description" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://DB3UCAMZ89-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="openUC2 Documentation" href="/opensearch.xml">

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>var pdfData={};const getBaseUrl=function(n){return"/"},getDownloadItems=function(){for(var n,e=[],t=pdfData[(n=document.location.pathname,n.endsWith("/")?n.slice(0,-1):n)]||[],o=0,l=t.length;o<l;o++)"root"!==t[o].type?"section"!==t[o].type?"chapter"===t[o].type&&e.push({title:"Download page: <br/> <strong style=font-size:16px>"+t[o].label+"</strong>",path:"/"+t[o].file}):e.push({title:"Download section: <br/> <strong style=font-size:16px>"+t[o].label+"</strong>",path:"/"+t[o].file}):e.push({title:"Download complete version: <br/> <strong style=font-size:16px>"+t[o].label+"</strong>",path:"/"+t[o].file});return e},fillDownloadDropdownMenu=function(){$("#pdfDownloadMenuList").empty();const n=getDownloadItems();var e="";n.forEach((function(n){e+="<li>",e+='<a class="dropdown__link" href="'+n.path+'" download>'+n.title+"</a>",e+="</li>"})),0===e.length&&(e="<li>No PDF downloads on this page</li>"),$("#pdfDownloadMenuList").append(e)},fillDownloadSidebarMenu=function(){$("#pdfLinkSidebarMenu").empty();const n=getDownloadItems();var e="";n.forEach((function(n){e+='<li class="menu__list-item">',e+='<a class="menu__link" href="'+n.path+'" download>'+n.title+"</a>",e+="</li>"})),0===e.length&&(e="<li>No PDF downloads on this page</li>"),$("#pdfLinkSidebarMenu").append(e)},checkAndInsertPdfButtons=function(){if($("html").hasClass("plugin-docs")){if(!$("#pdfLink").length){var n=$('<div class="navbar__item dropdown dropdown--hoverable dropdown--right" id="pdfDownloadMenu">  <a class="navbar__item navbar__link pdfLink" id="pdfLink" href="#">Download as PDF</a>  <ul class="dropdown__menu" id="pdfDownloadMenuList"></ul></div>');$(".navbar__items--right").prepend(n),$("#pdfDownloadMenu").mouseenter(fillDownloadDropdownMenu)}if(!$("#pdfLinkSidebar").length){var e=$('<li class="menu__list-item menu__list-item--collapsed" id="pdfLinkSidebar"><a role="button" class="menu__link menu__link--sublist">Download as PDF</a><ul class="menu__list" id="pdfLinkSidebarMenu" style=""></ul></li>');$(".navbar-sidebar__items > .menu > .menu__list").append(e),$("#pdfLinkSidebar").click((function(){$("#pdfLinkSidebar").toggleClass("menu__list-item--collapsed")})),$(".navbar__toggle").click(fillDownloadSidebarMenu)}}};$(window).on("load",(function(){fetch("/pdfs.json").then((n=>n.json())).then((function(n){pdfData=n,checkAndInsertPdfButtons(),setInterval(checkAndInsertPdfButtons,1e3)}))}))</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.2142b3d2.css">
<link rel="preload" href="/assets/js/runtime~main.7503dd27.js" as="script">
<link rel="preload" href="/assets/js/main.8ad6ba98.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Artboard4@4x.png" alt="openUC2 Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/Artboard4@4x.png" alt="openUC2 Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">openUC2 Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openuc2/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/General/ModuleDeveloperKit/">General</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Toolboxes/">Educational Kits</a><button aria-label="Toggle the collapsible sidebar category &#x27;Educational Kits&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Investigator/ZMicroscope/UpackZMicroscope">Investigator</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Electronics/uc2e1">Electronics</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e1">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e2v2">UC2 Standalone Board V2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e2v3">UC2 Standalone Board V3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e3">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e5">REST principle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e5.1">REST commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e6">Connecting devices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e7">Controlling the UC2e</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/Controlling_the_ESP32_APP">UC2Serial Android App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e8">Compiling from Scratch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e9">Replace Hardware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/PS4-Controller">PS4-Controller</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/StepperMotorBackpack">Documentation for Stepper Motor Controller with Rotational Encoder (TMC2209 + AS5600)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/RaspberryPiHat+">HAT+</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/CANBusIntegration">CANBusIntegration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/uc2e5.2">Python commands</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Electronics/UC2-ESP/Setup_Buildenvironment">UC2-ESP</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Electronics/UC2-ESP/Setup_Buildenvironment">UC2-ESP Firmware for the openUC2 UC2e electronics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Electronics/UC2-ESP/UC2_Firmware_Description">UC2-ESP32 Firmware Documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Electronics/UC2-ESP/APIDescription/INTRO">APIDescription</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Electronics/UC2-REST/INTRO">UC2-REST</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/ImSwitch/DahengCamera">ImSwitch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/WORKSHOPS/">openUC2 Workshops</a><button aria-label="Toggle the collapsible sidebar category &#x27;openUC2 Workshops&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/PRODUCTION/INVESTIGATOR/ProductionXYZMicroscope">PRODUCTION</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">openUC2 Documentation</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Electronics</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">UC2-ESP</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">UC2-ESP32 Firmware Documentation</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>UC2-ESP32 Firmware Documentation</h1><p>Welcome to the UC2-ESP32 firmware documentation! This guide provides detailed information on using, configuring, and extending the UC2-ESP32 firmware to control a microscope via USB Serial, Bluetooth, and WiFi using an ESP32 microcontroller. The firmware is modular, allowing easy customization for various hardware setups and requirements.</p><p><a href="https://github.com/youseetoo/uc2-esp32/tree/reworkBD" target="_blank" rel="noopener noreferrer">https://github.com/youseetoo/uc2-esp32/tree/reworkBD</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="contents">Contents<a class="hash-link" href="#contents" title="Direct link to heading">​</a></h2><ol><li><a href="#1-overview">Overview</a></li><li><a href="#2-firmware-architecture">Firmware Architecture</a></li><li><a href="#3-controllers-and-their-functions">Controllers and Their Functions</a></li><li><a href="#4-common-controller-functions">Common Controller Functions</a></li><li><a href="#5-compiling-switches-and-configuration">Compiling Switches and Configuration</a></li><li><a href="#6-typical-use-case-configurations">Typical Use Case Configurations</a></li><li><a href="#7-how-to-modify-and-extend">How to Modify and Extend</a></li><li><a href="#8-troubleshooting-and-debugging">Troubleshooting and Debugging</a></li><li><a href="#9-Common-Controller-Functions">Get, Act, Setup, loop?</a></li><li><a href="#10">Serial Communication</a></li></ol><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-overview">1. Overview<a class="hash-link" href="#1-overview" title="Direct link to heading">​</a></h2><p>The <code>uc2-esp32</code> firmware is a versatile control system designed for microscopes. It operates on an ESP32 microcontroller and enables communication via USB Serial, Bluetooth, and WiFi. The firmware is highly modular, supporting various hardware controllers and sensors, which can be enabled or disabled using compiling switches.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-firmware-architecture">2. Firmware Architecture<a class="hash-link" href="#2-firmware-architecture" title="Direct link to heading">​</a></h2><p>The firmware is structured into several directories and configuration files:</p><ul><li><strong>Main Source Directory</strong>: The core functionalities and controller implementations are located in the <code>main</code> directory.</li><li><strong>Key Configuration Files</strong>:<ul><li><code>platformio.ini</code>: PlatformIO configuration file for building and deploying the firmware.</li><li><code>CMakeLists.txt</code>: Build configuration for CMake.</li></ul></li><li><strong>Key Documentation Files</strong>:<ul><li><code>README.md</code>: General project information.</li><li><code>DOC_Firmware.md</code>: In-depth firmware documentation.</li><li><code>RestApi.md</code>: Documentation for the REST API.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="directory-structure">Directory Structure<a class="hash-link" href="#directory-structure" title="Direct link to heading">​</a></h3><ul><li><strong>include</strong>: Header files.</li><li><strong>lib</strong>: Libraries used by the firmware.</li><li><strong>main</strong>: Main source files and controller implementations.</li><li><strong>test</strong>: Testing scripts and configurations.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-controllers-and-their-functions">3. Controllers and Their Functions<a class="hash-link" href="#3-controllers-and-their-functions" title="Direct link to heading">​</a></h2><p>The firmware includes various controllers to manage different hardware components. Each controller is implemented in the <code>src</code> directory and follows a standardized interface.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-motor-controller-srcmotor">3.1 Motor Controller (<code>src/motor</code>)<a class="hash-link" href="#31-motor-controller-srcmotor" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Manages the motors for focusing and positioning in the microscope.</li><li><strong>Key Components</strong>:<ul><li><code>FocusMotor.cpp/h</code>: Controls the focus adjustment.</li><li><code>HomeDrive.cpp/h</code>: Handles motor homing routines.</li><li><code>StageScan.cpp/h</code>: Manages stage scanning movements.</li><li><code>AccelStep.cpp/h</code> and <code>FAccelStep.cpp/h</code>: Motor acceleration control.</li></ul></li><li><strong>Features</strong>:<ul><li>Supports I2C communication for motor control.</li><li>Includes acceleration and homing functionalities.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-wifi-controller-srcwifi">3.2 WiFi Controller (<code>src/wifi</code>)<a class="hash-link" href="#32-wifi-controller-srcwifi" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Manages WiFi connectivity.</li><li><strong>Features</strong>:<ul><li>Configures and manages WiFi connections.</li><li>Supports data transmission over WiFi.</li><li>Integration with cloud services or remote control.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-bluetooth-controller-srcbt">3.3 Bluetooth Controller (<code>src/bt</code>)<a class="hash-link" href="#33-bluetooth-controller-srcbt" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Provides Bluetooth communication capabilities.</li><li><strong>Features</strong>:<ul><li>Supports communication with Bluetooth-enabled devices.</li><li>Configurable pairing and communication protocols.</li><li>This includes the communication with a PS4 controller</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-serial-controller-srcserial">3.4 Serial Controller (<code>src/serial</code>)<a class="hash-link" href="#34-serial-controller-srcserial" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Handles USB serial communication.</li><li><strong>Features</strong>:<ul><li>Enables direct communication with a computer.</li><li>Useful for command input and data logging.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-laser-controller-srclaser">3.5 Laser Controller (<code>src/laser</code>)<a class="hash-link" href="#35-laser-controller-srclaser" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Controls laser operations for imaging.</li><li><strong>Features</strong>:<ul><li>Turn the laser on/off.</li><li>Adjust laser power levels.</li><li>Synchronization with imaging tasks.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="36-led-controller-srcled">3.6 LED Controller (<code>src/led</code>)<a class="hash-link" href="#36-led-controller-srcled" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Manages LED lighting.</li><li><strong>Features</strong>:<ul><li>Provides adjustable illumination.</li><li>Synchronization with other imaging components.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="37-pid-controller-srcpid">3.7 PID Controller (<code>src/pid</code>)<a class="hash-link" href="#37-pid-controller-srcpid" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Implements PID control for precision operations.</li><li><strong>Features</strong>:<ul><li>Fine-tune motor movements.</li><li>Maintain precise control over environmental parameters.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="38-i2c-communication-srci2c">3.8 I2C Communication (<code>src/i2c</code>)<a class="hash-link" href="#38-i2c-communication-srci2c" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Manages I2C communication.</li><li><strong>Features</strong>:<ul><li>Supports multiple I2C addresses.</li><li>Integrates with other controllers for peripheral communication.</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-common-controller-functions">4. Common Controller Functions<a class="hash-link" href="#4-common-controller-functions" title="Direct link to heading">​</a></h2><p>Each controller implements a standardized set of functions that define its interaction with the firmware:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-setup-function">4.1 <code>setup()</code> Function<a class="hash-link" href="#41-setup-function" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Initializes the controller and prepares it for operation.</li><li><strong>Activities</strong>:<ul><li>Configures hardware peripherals (e.g., GPIO, I2C).</li><li>Sets initial configuration parameters.</li><li>Registers the controller with the main system.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-loop-function">4.2 <code>loop()</code> Function<a class="hash-link" href="#42-loop-function" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Executes continuously to maintain controller operations.</li><li><strong>Activities</strong>:<ul><li>Monitors sensor inputs and device status.</li><li>Manages ongoing tasks (e.g., motor control, LED brightness adjustment).</li><li>Handles asynchronous events.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-act-function">4.3 <code>act()</code> Function<a class="hash-link" href="#43-act-function" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Executes specific actions in response to commands.</li><li><strong>Activities</strong>:<ul><li>Moves motors to specific positions.</li><li>Changes settings or operational modes.</li><li>Handles external commands (e.g., turn on/off a device).</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-get-function">4.4 <code>get()</code> Function<a class="hash-link" href="#44-get-function" title="Direct link to heading">​</a></h3><ul><li><strong>Purpose</strong>: Retrieves the current state or values from the controller.</li><li><strong>Activities</strong>:<ul><li>Provides real-time data (e.g., sensor readings, motor positions).</li><li>Returns status information (e.g., connection status).</li><li>Accesses configuration parameters.</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-compiling-switches-and-configuration">5. Compiling Switches and Configuration<a class="hash-link" href="#5-compiling-switches-and-configuration" title="Direct link to heading">​</a></h2><p>The firmware is configurable through various compiling switches and settings, allowing it to be tailored for different hardware and use cases.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-common-compiling-switches">5.1 Common Compiling Switches<a class="hash-link" href="#51-common-compiling-switches" title="Direct link to heading">​</a></h3><ul><li><strong><code>USE_TCA9535</code></strong>: Enables TCA9535 I2C GPIO expander support.</li><li><strong><code>USE_FASTACCEL</code></strong>: Activates fast acceleration profiles for motor control.</li><li><strong><code>USE_ACCELSTEP</code></strong>: Includes acceleration step control.</li><li><strong><code>HOME_MOTOR</code></strong>: Enables motor homing functionality.</li><li><strong><code>STAGE_SCAN</code></strong>: Activates scanning stage control.</li><li><strong><code>USE_I2C</code></strong>: Enables I2C communication.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-configuration-files">5.2 Configuration Files<a class="hash-link" href="#52-configuration-files" title="Direct link to heading">​</a></h3><ul><li><strong><code>platformio.ini</code></strong>: Configures the build environment, board settings, and embedded files. Key settings include:<ul><li>Frameworks: <code>espidf</code> and <code>arduino</code>.</li><li>CPU and flash speed.</li><li>Custom partition schemes.</li><li>Build flags for managing compiler behavior.</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-typical-use-case-configurations">6. Typical Use Case Configurations<a class="hash-link" href="#6-typical-use-case-configurations" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-basic-microscope-setup">6.1 Basic Microscope Setup<a class="hash-link" href="#61-basic-microscope-setup" title="Direct link to heading">​</a></h3><ul><li><strong>Controllers</strong>: Motor (<code>FocusMotor</code>, <code>HomeDrive</code>), Serial.</li><li><strong>Features</strong>: Basic motor control for focusing, serial communication for direct commands.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-advanced-imaging-setup">6.2 Advanced Imaging Setup<a class="hash-link" href="#62-advanced-imaging-setup" title="Direct link to heading">​</a></h3><ul><li><strong>Controllers</strong>: Motor, WiFi, Bluetooth, Laser, PID.</li><li><strong>Features</strong>: Advanced motor control, remote connectivity via WiFi and Bluetooth, laser control for precise illumination, and PID for fine-tuning.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-how-to-modify-and-extend">7. How to Modify and Extend<a class="hash-link" href="#7-how-to-modify-and-extend" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="71-adding-new-controllers">7.1 Adding New Controllers<a class="hash-link" href="#71-adding-new-controllers" title="Direct link to heading">​</a></h3><ol><li>Implement the new controller in the <code>src</code> directory.</li><li>Register the controller&#x27;s <code>setup()</code>, <code>loop()</code>, <code>act()</code>, and <code>get()</code> functions in the main firmware loop.</li><li>Modify configuration files as necessary to include the new controller.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="72-modifying-existing-behavior">7.2 Modifying Existing Behavior<a class="hash-link" href="#72-modifying-existing-behavior" title="Direct link to heading">​</a></h3><ol><li>Adjust settings in configuration files (<code>platformio.ini</code>, header files).</li><li>Use compilation switches to enable or disable specific features.</li><li>Update the controller&#x27;s code to change its functionality.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="73-compiling-the-firmware">7.3 Compiling the Firmware<a class="hash-link" href="#73-compiling-the-firmware" title="Direct link to heading">​</a></h3><ul><li>Use PlatformIO commands to build and upload the firmware:<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">platformio run --target upload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-troubleshooting-and-debugging">8. Troubleshooting and Debugging<a class="hash-link" href="#8-troubleshooting-and-debugging" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="81-common-issues">8.1 Common Issues<a class="hash-link" href="#81-common-issues" title="Direct link to heading">​</a></h3><ul><li><strong>Incorrect Board Configuration</strong>: Check <code>platformio.ini</code> for correct board and environment settings.</li><li><strong>Communication Failures</strong>: Verify WiFi, Bluetooth, and serial configurations.</li><li><strong>Motor Control Problems</strong>: Ensure motor drivers are properly connected and configured.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="82-debugging-tips">8.2 Debugging Tips<a class="hash-link" href="#82-debugging-tips" title="Direct link to heading">​</a></h3><ul><li>Use serial debugging to trace communication and command handling.</li><li>Review log messages for error information and troubleshooting guidance.</li><li>Verify hardware connections and configurations.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-common-controller-functions">9. <strong>Common Controller Functions</strong><a class="hash-link" href="#9-common-controller-functions" title="Direct link to heading">​</a></h2><p>Each controller in the <code>uc2-esp32</code> firmware typically implements a standardized set of functions: <code>act()</code>, <code>get()</code>, <code>setup()</code>, and <code>loop()</code>. These functions define how each controller interacts with the system, handles commands, and maintains its state. This common structure ensures consistency across different modules, making it easier to manage and extend the firmware.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="91-setup-function">9.1 <strong><code>setup()</code> Function</strong><a class="hash-link" href="#91-setup-function" title="Direct link to heading">​</a></h3><ul><li><p><strong>Purpose</strong>: The <code>setup()</code> function is called during the initialization phase of the firmware. Its primary role is to configure the controller and prepare it for operation. This may involve setting up hardware peripherals, initializing communication interfaces, and configuring initial parameters.</p></li><li><p><strong>Typical Activities</strong>:</p><ul><li>Initializing GPIO pins or communication protocols (e.g., I2C, SPI).</li><li>Setting default values for configuration parameters.</li><li>Establishing initial connections (e.g., WiFi or Bluetooth pairing).</li><li>Registering the controller with the main control loop.</li></ul></li><li><p><strong>Example Usage</strong>:</p><ul><li>In a motor controller, <code>setup()</code> might configure the motor driver pins and initialize the stepper motor library.</li><li>For a WiFi controller, <code>setup()</code> would configure the WiFi settings and start the connection process.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="92-loop-function">9.2 <strong><code>loop()</code> Function</strong><a class="hash-link" href="#92-loop-function" title="Direct link to heading">​</a></h3><ul><li><p><strong>Purpose</strong>: The <code>loop()</code> function is executed continuously in the main loop of the firmware. It handles ongoing tasks and ensures that the controller maintains its operations over time. This function is essential for tasks that require regular updates, such as checking sensor readings or managing ongoing communications.</p></li><li><p><strong>Typical Activities</strong>:</p><ul><li>Monitoring sensor inputs or checking the status of external devices.</li><li>Managing continuous output (e.g., adjusting motor position or updating LED brightness).</li><li>Handling asynchronous events (e.g., receiving data from a WiFi connection).</li><li>Performing regular checks and maintenance tasks.</li></ul></li><li><p><strong>Example Usage</strong>:</p><ul><li>In a laser controller, <code>loop()</code> could check and maintain the laser&#x27;s power level and operational state.</li><li>A PID controller might use <code>loop()</code> to constantly read sensor inputs and adjust outputs to maintain the desired state.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="93-act-function">9.3 <strong><code>act()</code> Function</strong><a class="hash-link" href="#93-act-function" title="Direct link to heading">​</a></h3><ul><li><p><strong>Purpose</strong>: The <code>act()</code> function is called in response to specific commands or actions that need to be taken by the controller. This function processes incoming commands, interprets them, and executes the appropriate actions. It is often invoked based on external inputs or events triggered by other parts of the system.</p></li><li><p><strong>Typical Activities</strong>:</p><ul><li>Executing a command to move a motor to a specific position.</li><li>Turning on or off a device like a laser or LED.</li><li>Changing the configuration settings of the controller (e.g., setting a new target temperature).</li></ul></li><li><p><strong>Example Usage</strong>:</p><ul><li>In a motor controller, <code>act()</code> could be used to receive commands for moving to a specific coordinate and then executing the move.</li><li>For a WiFi controller, <code>act()</code> might handle a command to change the network settings or initiate a data transmission.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="94-get-function">9.4 <strong><code>get()</code> Function</strong><a class="hash-link" href="#94-get-function" title="Direct link to heading">​</a></h3><ul><li><p><strong>Purpose</strong>: The <code>get()</code> function is used to retrieve the current state or value from the controller. This function provides a way to access real-time data or the current configuration of the controller. It is often used for monitoring, diagnostics, or feedback purposes.</p></li><li><p><strong>Typical Activities</strong>:</p><ul><li>Returning sensor values or current positions (e.g., the current position of a motor).</li><li>Providing status information (e.g., connection status of a WiFi module).</li><li>Accessing configuration parameters or operational states.</li></ul></li><li><p><strong>Example Usage</strong>:</p><ul><li>In a temperature controller, <code>get()</code> could return the current temperature reading.</li><li>For a laser controller, <code>get()</code> might provide information on whether the laser is currently active and at what power level.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="95-integration-of-common-functions">9.5 <strong>Integration of Common Functions</strong><a class="hash-link" href="#95-integration-of-common-functions" title="Direct link to heading">​</a></h3><p>These common functions (<code>act()</code>, <code>get()</code>, <code>setup()</code>, and <code>loop()</code>) are registered within each controller and integrated into the overall system architecture of the <code>uc2-esp32</code> firmware. The <code>setup()</code> function is typically called once during initialization, while <code>loop()</code> runs continuously. <code>act()</code> and <code>get()</code> are invoked as needed based on user commands or system events.</p><p>By standardizing these functions across different controllers, the firmware achieves modularity and consistency, enabling easier maintenance and extension. Developers can add new controllers or modify existing ones without disrupting the overall system, as long as they adhere to this standardized function interface.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="10-serial-interface-and-command-syntax">10. Serial Interface and Command Syntax<a class="hash-link" href="#10-serial-interface-and-command-syntax" title="Direct link to heading">​</a></h2><p>The <code>uc2-esp32</code> firmware provides a Serial interface that allows users to communicate with the microcontroller using a standard USB connection. This interface is critical for sending commands, receiving data, and debugging the system. Below, we explain how to formulate and send commands over the Serial interface, focusing on motor control as an example.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="101-connecting-via-serial">10.1 Connecting via Serial<a class="hash-link" href="#101-connecting-via-serial" title="Direct link to heading">​</a></h3><p>To connect to the ESP32 via Serial:</p><ol><li>Connect the ESP32 to your computer using a USB cable.</li><li>Open a serial terminal application (e.g., Arduino Serial Monitor, PuTTY, or any other terminal program).</li><li>Set the correct COM port associated with the ESP32 device.</li><li>Configure the baud rate (typically 115200 baud for <code>uc2-esp32</code>).</li><li>Set the terminal to use NL (New Line) or CR+LF (Carriage Return + Line Feed) as the line-ending character.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="102-command-structure">10.2 Command Structure<a class="hash-link" href="#102-command-structure" title="Direct link to heading">​</a></h3><p>Commands sent over the Serial interface typically follow a JSON format to ensure structured data communication. The JSON format allows</p><p> for easy parsing and flexibility in command structure. Each command consists of a key-value pair where the key indicates the action and the value provides parameters.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-json-command">Example JSON Command:<a class="hash-link" href="#example-json-command" title="Direct link to heading">​</a></h4><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;command&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;motor_move&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;axis&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;position&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;speed&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="103-common-serial-commands">10.3 Common Serial Commands<a class="hash-link" href="#103-common-serial-commands" title="Direct link to heading">​</a></h3><p>Below are some common Serial commands used to control various aspects of the microscope:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1031-motor-control-commands">10.3.1 Motor Control Commands<a class="hash-link" href="#1031-motor-control-commands" title="Direct link to heading">​</a></h4><ul><li><p><strong>Move Motor to a Specific Position</strong>:</p><ul><li><strong>Command</strong>: <code>motor_move</code></li><li><strong>Description</strong>: Moves the specified motor to a given position.</li><li><strong>Parameters</strong>:<ul><li><code>axis</code>: Specifies which motor to move (<code>&quot;x&quot;</code>, <code>&quot;y&quot;</code>, <code>&quot;z&quot;</code>, etc.).</li><li><code>position</code>: Target position for the motor in steps or encoder counts.</li><li><code>speed</code>: (Optional) Speed at which to move the motor.</li></ul></li></ul><p><strong>Example</strong>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;command&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;motor_move&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;axis&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;position&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;speed&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Set Motor Speed</strong>:</p><ul><li><strong>Command</strong>: <code>motor_speed</code></li><li><strong>Description</strong>: Sets the speed of the specified motor.</li><li><strong>Parameters</strong>:<ul><li><code>axis</code>: Specifies which motor to control (<code>&quot;x&quot;</code>, <code>&quot;y&quot;</code>, <code>&quot;z&quot;</code>, etc.).</li><li><code>speed</code>: Speed value to set.</li></ul></li></ul><p><strong>Example</strong>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;command&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;motor_speed&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;axis&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;speed&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">300</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Home Motor</strong>:</p><ul><li><strong>Command</strong>: <code>motor_home</code></li><li><strong>Description</strong>: Homes the specified motor to its reference or starting position.</li><li><strong>Parameters</strong>:<ul><li><code>axis</code>: Specifies which motor to home (<code>&quot;x&quot;</code>, <code>&quot;y&quot;</code>, <code>&quot;z&quot;</code>, etc.).</li></ul></li></ul><p><strong>Example</strong>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;command&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;motor_home&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;axis&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1032-led-and-laser-control-commands">10.3.2 LED and Laser Control Commands<a class="hash-link" href="#1032-led-and-laser-control-commands" title="Direct link to heading">​</a></h4><ul><li><p><strong>Turn On/Off LED</strong>:</p><ul><li><strong>Command</strong>: <code>led_control</code></li><li><strong>Description</strong>: Controls the LED state (on/off).</li><li><strong>Parameters</strong>:<ul><li><code>state</code>: <code>&quot;on&quot;</code> or <code>&quot;off&quot;</code>.</li></ul></li></ul><p><strong>Example</strong>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;command&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;led_control&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;state&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;on&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Set Laser Power</strong>:</p><ul><li><strong>Command</strong>: <code>laser_power</code></li><li><strong>Description</strong>: Sets the laser power level.</li><li><strong>Parameters</strong>:<ul><li><code>power</code>: Power level value (e.g., 0-100%).</li></ul></li></ul><p><strong>Example</strong>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;command&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;laser_power&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;power&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">75</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="104-sending-commands">10.4 Sending Commands<a class="hash-link" href="#104-sending-commands" title="Direct link to heading">​</a></h3><p>To send commands:</p><ol><li>Formulate the command in the correct JSON format.</li><li>Copy the JSON string into the serial terminal input.</li><li>Press Enter to send the command to the ESP32.</li><li>The ESP32 will parse the command and execute the corresponding action. You can view the response or status output in the serial terminal.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="105-receiving-responses">10.5 Receiving Responses<a class="hash-link" href="#105-receiving-responses" title="Direct link to heading">​</a></h3><p>The ESP32 may send responses or status updates back over the Serial interface. Responses are usually in JSON format, providing information about the executed command or system state.</p><p><strong>Example Response</strong>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;success&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Motor moved to position 1000 on axis z.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="106-error-handling">10.6 Error Handling<a class="hash-link" href="#106-error-handling" title="Direct link to heading">​</a></h3><p>If a command is incorrect or cannot be executed, the firmware will return an error response. It is important to handle such responses gracefully and adjust commands as needed.</p><p><strong>Example Error Response</strong>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;error&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Invalid axis specified in motor_move command.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Electronics/UC2-ESP/Setup_Buildenvironment"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">UC2-ESP Firmware for the openUC2 UC2e electronics</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Electronics/UC2-ESP/APIDescription/INTRO"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">UC2-ESP</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#contents" class="table-of-contents__link toc-highlight">Contents</a></li><li><a href="#1-overview" class="table-of-contents__link toc-highlight">1. Overview</a></li><li><a href="#2-firmware-architecture" class="table-of-contents__link toc-highlight">2. Firmware Architecture</a><ul><li><a href="#directory-structure" class="table-of-contents__link toc-highlight">Directory Structure</a></li></ul></li><li><a href="#3-controllers-and-their-functions" class="table-of-contents__link toc-highlight">3. Controllers and Their Functions</a><ul><li><a href="#31-motor-controller-srcmotor" class="table-of-contents__link toc-highlight">3.1 Motor Controller (<code>src/motor</code>)</a></li><li><a href="#32-wifi-controller-srcwifi" class="table-of-contents__link toc-highlight">3.2 WiFi Controller (<code>src/wifi</code>)</a></li><li><a href="#33-bluetooth-controller-srcbt" class="table-of-contents__link toc-highlight">3.3 Bluetooth Controller (<code>src/bt</code>)</a></li><li><a href="#34-serial-controller-srcserial" class="table-of-contents__link toc-highlight">3.4 Serial Controller (<code>src/serial</code>)</a></li><li><a href="#35-laser-controller-srclaser" class="table-of-contents__link toc-highlight">3.5 Laser Controller (<code>src/laser</code>)</a></li><li><a href="#36-led-controller-srcled" class="table-of-contents__link toc-highlight">3.6 LED Controller (<code>src/led</code>)</a></li><li><a href="#37-pid-controller-srcpid" class="table-of-contents__link toc-highlight">3.7 PID Controller (<code>src/pid</code>)</a></li><li><a href="#38-i2c-communication-srci2c" class="table-of-contents__link toc-highlight">3.8 I2C Communication (<code>src/i2c</code>)</a></li></ul></li><li><a href="#4-common-controller-functions" class="table-of-contents__link toc-highlight">4. Common Controller Functions</a><ul><li><a href="#41-setup-function" class="table-of-contents__link toc-highlight">4.1 <code>setup()</code> Function</a></li><li><a href="#42-loop-function" class="table-of-contents__link toc-highlight">4.2 <code>loop()</code> Function</a></li><li><a href="#43-act-function" class="table-of-contents__link toc-highlight">4.3 <code>act()</code> Function</a></li><li><a href="#44-get-function" class="table-of-contents__link toc-highlight">4.4 <code>get()</code> Function</a></li></ul></li><li><a href="#5-compiling-switches-and-configuration" class="table-of-contents__link toc-highlight">5. Compiling Switches and Configuration</a><ul><li><a href="#51-common-compiling-switches" class="table-of-contents__link toc-highlight">5.1 Common Compiling Switches</a></li><li><a href="#52-configuration-files" class="table-of-contents__link toc-highlight">5.2 Configuration Files</a></li></ul></li><li><a href="#6-typical-use-case-configurations" class="table-of-contents__link toc-highlight">6. Typical Use Case Configurations</a><ul><li><a href="#61-basic-microscope-setup" class="table-of-contents__link toc-highlight">6.1 Basic Microscope Setup</a></li><li><a href="#62-advanced-imaging-setup" class="table-of-contents__link toc-highlight">6.2 Advanced Imaging Setup</a></li></ul></li><li><a href="#7-how-to-modify-and-extend" class="table-of-contents__link toc-highlight">7. How to Modify and Extend</a><ul><li><a href="#71-adding-new-controllers" class="table-of-contents__link toc-highlight">7.1 Adding New Controllers</a></li><li><a href="#72-modifying-existing-behavior" class="table-of-contents__link toc-highlight">7.2 Modifying Existing Behavior</a></li><li><a href="#73-compiling-the-firmware" class="table-of-contents__link toc-highlight">7.3 Compiling the Firmware</a></li></ul></li><li><a href="#8-troubleshooting-and-debugging" class="table-of-contents__link toc-highlight">8. Troubleshooting and Debugging</a><ul><li><a href="#81-common-issues" class="table-of-contents__link toc-highlight">8.1 Common Issues</a></li><li><a href="#82-debugging-tips" class="table-of-contents__link toc-highlight">8.2 Debugging Tips</a></li></ul></li><li><a href="#9-common-controller-functions" class="table-of-contents__link toc-highlight">9. <strong>Common Controller Functions</strong></a><ul><li><a href="#91-setup-function" class="table-of-contents__link toc-highlight">9.1 <strong><code>setup()</code> Function</strong></a></li><li><a href="#92-loop-function" class="table-of-contents__link toc-highlight">9.2 <strong><code>loop()</code> Function</strong></a></li><li><a href="#93-act-function" class="table-of-contents__link toc-highlight">9.3 <strong><code>act()</code> Function</strong></a></li><li><a href="#94-get-function" class="table-of-contents__link toc-highlight">9.4 <strong><code>get()</code> Function</strong></a></li><li><a href="#95-integration-of-common-functions" class="table-of-contents__link toc-highlight">9.5 <strong>Integration of Common Functions</strong></a></li></ul></li><li><a href="#10-serial-interface-and-command-syntax" class="table-of-contents__link toc-highlight">10. Serial Interface and Command Syntax</a><ul><li><a href="#101-connecting-via-serial" class="table-of-contents__link toc-highlight">10.1 Connecting via Serial</a></li><li><a href="#102-command-structure" class="table-of-contents__link toc-highlight">10.2 Command Structure</a></li><li><a href="#103-common-serial-commands" class="table-of-contents__link toc-highlight">10.3 Common Serial Commands</a></li><li><a href="#104-sending-commands" class="table-of-contents__link toc-highlight">10.4 Sending Commands</a></li><li><a href="#105-receiving-responses" class="table-of-contents__link toc-highlight">10.5 Receiving Responses</a></li><li><a href="#106-error-handling" class="table-of-contents__link toc-highlight">10.6 Error Handling</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://youseetoo.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discourse<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/OpenUc2" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/openuc2/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 openUC2.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7503dd27.js"></script>
<script src="/assets/js/main.8ad6ba98.js"></script>
</body>
</html>