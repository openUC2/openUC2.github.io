"use strict";(self.webpackChunkuc_2_docs=self.webpackChunkuc_2_docs||[]).push([[4403],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>d});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=c(n),d=i,f=u["".concat(s,".").concat(d)]||u[d]||p[d]||a;return n?r.createElement(f,l(l({ref:t},m),{},{components:n})):r.createElement(f,l({ref:t},m))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,l=new Array(a);l[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var c=2;c<a;c++)l[c]=n[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},82146:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var r=n(87462),i=(n(67294),n(3905));const a={id:"TMC",title:"TMC"},l="UC2-ESP TMC Controller API Documentation",o={unversionedId:"Electronics/Advanced/UC2-ESP32/APIDescription/TMC",id:"Electronics/Advanced/UC2-ESP32/APIDescription/TMC",title:"TMC",description:"The UC2-ESP firmware provides an API to configure and manage Trinamic TMC2209 stepper drivers, allowing fine-tuned control over microstepping, current settings, stall detection, and other driver parameters.",source:"@site/docs/04_Electronics/10_Advanced/01_UC2-ESP32/APIDescription/TMC.md",sourceDirName:"04_Electronics/10_Advanced/01_UC2-ESP32/APIDescription",slug:"/Electronics/Advanced/UC2-ESP32/APIDescription/TMC",permalink:"/docs/Electronics/Advanced/UC2-ESP32/APIDescription/TMC",draft:!1,tags:[],version:"current",frontMatter:{id:"TMC",title:"TMC"},sidebar:"tutorialSidebar",previous:{title:"PinConfig",permalink:"/docs/Electronics/Advanced/UC2-ESP32/APIDescription/PinConfig"},next:{title:"UC2-REST Python Interface",permalink:"/docs/Electronics/Advanced/UC2-REST/"}},s={},c=[{value:"Endpoint",id:"endpoint",level:2},{value:"Request Format",id:"request-format",level:2},{value:"JSON Parameters Description",id:"json-parameters-description",level:2},{value:"Example Requests",id:"example-requests",level:2},{value:"Configure TMC2209 on Axis 0",id:"configure-tmc2209-on-axis-0",level:3},{value:"Configure TMC2209 on Axis 3 with 32 microsteps",id:"configure-tmc2209-on-axis-3-with-32-microsteps",level:3},{value:"Reset TMC2209 settings to defaults",id:"reset-tmc2209-settings-to-defaults",level:3},{value:"Endpoint to Retrieve TMC2209 Configuration",id:"endpoint-to-retrieve-tmc2209-configuration",level:2},{value:"Example Request",id:"example-request",level:3},{value:"Response Format",id:"response-format",level:3},{value:"Conclusion",id:"conclusion",level:2}],m={toc:c};function p(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"uc2-esp-tmc-controller-api-documentation"},"UC2-ESP TMC Controller API Documentation"),(0,i.kt)("p",null,"The UC2-ESP firmware provides an API to configure and manage Trinamic TMC2209 stepper drivers, allowing fine-tuned control over microstepping, current settings, stall detection, and other driver parameters."),(0,i.kt)("h2",{id:"endpoint"},"Endpoint"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Endpoint:")," ",(0,i.kt)("inlineCode",{parentName:"p"},"/tmc_act")),(0,i.kt)("p",null,"Used to modify the TMC2209 settings."),(0,i.kt)("h2",{id:"request-format"},"Request Format"),(0,i.kt)("p",null,"The API expects a JSON document structured as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "task": "/tmc_act",\n  "qid": 1,\n  "axis": 0,\n  "msteps": 16,\n  "rms_current": 700,\n  "sgthrs": 15,\n  "semin": 5,\n  "semax": 2,\n  "blank_time": 24,\n  "toff": 4\n}\n')),(0,i.kt)("h2",{id:"json-parameters-description"},"JSON Parameters Description"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"task"),": Set to ",(0,i.kt)("inlineCode",{parentName:"li"},"/tmc_act")," to modify the driver settings."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"qid"),": (optional) Queue ID for tracking commands."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"axis"),": (optional) Specifies which axis to configure (relevant for CAN or I2C-controlled motors)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"msteps"),": Microsteps per full step (e.g., 16, 32, 64, etc.)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rms_current"),": RMS current in milliamps for motor drive."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sgthrs"),": StallGuard threshold value."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"semin"),": StallGuard minimum speed threshold."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"semax"),": StallGuard maximum speed threshold."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"blank_time"),": Blanking time for stall detection."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"toff"),": Time-off setting for motor driver PWM.")),(0,i.kt)("h2",{id:"example-requests"},"Example Requests"),(0,i.kt)("h3",{id:"configure-tmc2209-on-axis-0"},"Configure TMC2209 on Axis 0"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{"task": "/tmc_act", "msteps":16, "rms_current":700, "sgthrs":15, "semin":5, "semax":2, "blank_time":24, "toff":4, "axis":0}\n')),(0,i.kt)("h3",{id:"configure-tmc2209-on-axis-3-with-32-microsteps"},"Configure TMC2209 on Axis 3 with 32 microsteps"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{"task": "/tmc_act", "msteps":32, "rms_current":700, "sgthrs":15, "semin":5, "semax":2, "blank_time":24, "toff":4, "axis":3}\n')),(0,i.kt)("h3",{id:"reset-tmc2209-settings-to-defaults"},"Reset TMC2209 settings to defaults"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{"task": "/tmc_act", "reset": 1}\n')),(0,i.kt)("h2",{id:"endpoint-to-retrieve-tmc2209-configuration"},"Endpoint to Retrieve TMC2209 Configuration"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Endpoint:")," ",(0,i.kt)("inlineCode",{parentName:"p"},"/tmc_get")),(0,i.kt)("p",null,"Returns the current TMC2209 driver configuration and runtime parameters."),(0,i.kt)("h3",{id:"example-request"},"Example Request"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{"task": "/tmc_get"}\n')),(0,i.kt)("h3",{id:"response-format"},"Response Format"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "msteps": 32,\n  "msteps_": 32,\n  "rmscurr": 500,\n  "rmscurr_": 488,\n  "stall_value": 100,\n  "sgthrs": 15,\n  "semin": 5,\n  "semax": 2,\n  "sedn": 0,\n  "tcoolthrs": 1048575,\n  "blank_time": 24,\n  "toff": 4,\n  "SG_RESULT": 2,\n  "Current": 253\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"msteps"),": Configured microstep value."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"msteps_"),": Actual microstep value set in driver."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rmscurr"),": Configured RMS current."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rmscurr_"),": Actual RMS current measured in driver."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"stall_value"),": Stall detection threshold."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sgthrs"),": StallGuard threshold."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"semin"),": StallGuard minimum speed."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"semax"),": StallGuard maximum speed."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sedn"),": Stall detection hysteresis."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"tcoolthrs"),": Cool-down threshold for driver."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"blank_time"),": Time before stall detection activates."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"toff"),": Time-off setting for PWM control."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"SG_RESULT"),": StallGuard sensor result."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Current"),": Real-time current measurement.")),(0,i.kt)("h2",{id:"conclusion"},"Conclusion"),(0,i.kt)("p",null,"The TMC Controller API provides comprehensive access to the TMC2209 stepper driver, enabling precise tuning of microstepping, current settings, stall detection, and real-time monitoring for stable and efficient motor control."))}p.isMDXComponent=!0}}]);